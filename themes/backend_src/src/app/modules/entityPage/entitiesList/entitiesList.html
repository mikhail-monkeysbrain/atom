<div class="page page-table" style="position: relative;">
  <div data-ng-hide="renderData" class="dummy-height"></div>
  <section data-ng-show="renderData" class="panel panel-default table-dynamic">
    <div style="position: relative;" class="panel-heading text-right">
      <div id="table-title" style="position: absolute; left: 10px; top: 20px; font-weight: 600;"
           data-ng-bind="tableTitle"></div>
      <button tooltip="Добавить новый элемент" tooltip-placement="top" tooltip-append-to-body="true"  ng-show="createEnabled" class="btn btn-success btn-w-md listControlButtons" type="button" ng-click="new()">
        Добавить
      </button>
      <!--go(,true);-->
      <button tooltip="Экспорт элементов в XLS" tooltip-placement="top" tooltip-append-to-body="true"  ng-show="exportEnabled" class="btn btn-primary btn-w-md listControlButtons"
              ng-click="exportStack();" type="button">Выгрузить
      </button>
      <button tooltip="Удалить выбранные элементы" tooltip-placement="top" tooltip-append-to-body="true"  ng-show="deleteEnabled" ng-disabled="isSelectItems();" class="btn btn-danger  btn-w-md listControlButtons" ng-click="deleteStack();"
              type="button">Удалить
      </button>
      <form method="post" id="downloadForm"></form>
    </div>
    <div data-ng-show="list.scheme && hasSearchFields" class="table-filters">
      <div class="row">
        <div class="col-sm-4 col-xs-6">
          <form class="ng-scope ng-pristine ng-valid">
            <input type="text" placeholder="Поиск..." class="form-control ng-pristine ng-valid" ng-model="searchKeywords" ng-keyup="search()">
            <input type="hidden" value="" id="hidden-q">
          </form>
        </div>
        <!--<div class="col-sm-3 col-xs-6 filter-result-info">
            <span>
                Showing {{filteredStores.length}}/{{stores.length}} entries
            </span>
        </div>-->
      </div>
    </div>
<div class="table-responsive">
  <table id="table-{{model}}" class="table table-bordered table-striped table-responsive">
    <thead>
    <tr>
      <th style="width: 15px; padding-left: 10px;">
        <label style="margin-right: 0;" class="ui-checkbox">
          <input class="remAll" type="checkbox" value="" data-ng-click="selectAllItems($event);">
          <span></span>
        </label>
      </th>
      <th ng-repeat="(fieldKey, field) in list.scheme" ng-if="field.sort && fieldKey !== 'enabled' ">
        <div class="th">
          {{field.title}}
                        <span ng-show="field.sort" class="fa fa-angle-up"
                              ng-click=" order(fieldKey,-1) "
                              ng-class="{active: curSortField == fieldKey && curSortOrder == -1 }"></span>
                        <span ng-show="field.sort" class="fa fa-angle-down"
                              ng-click=" order(fieldKey,1) "
                              ng-class="{active: curSortField == fieldKey && curSortOrder == 1 }"></span>
        </div>
      </th>
      <th class="visible-td" ng-if="list.scheme.enabled">
        <div class="th">Доступность
                        <span class="fa fa-angle-up"
                              ng-click=" order('enabled',-1) "
                              ng-class="{active: curSortField == 'enabled' && curSortOrder == -1 }"></span>
                        <span class="fa fa-angle-down"
                              ng-click=" order('enabled',1) "
                              ng-class="{active: curSortField == 'enabled' && curSortOrder == 1 }"></span>
        </div>
      </th>
      <th class="action-th">
        <div class="th">Действия</div>
      </th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="item in renderData" >
      <td style="width: 15px;  padding-right: 0;">
        <label style="margin-right: 0;" class="ui-checkbox">
          <input class="remBox" type="checkbox" value="{{ item._id.$id }}" ng-click="updateRemItems($event);">
          <span></span>
        </label>
      </td>

      <td list-wrapp="{{item[fieldKey]}}" ng-repeat="(fieldKey, field) in list.scheme" ng-if="field.sort && fieldKey !== 'enabled'" entity-list-markup entity="item[fieldKey]" entity-name="fieldKey" field="field" >{{item[fieldKey]}}</td>


      <td class="visible-td" ng-if="list.scheme.enabled">
        <!--<label class="switch"  data-atom-toggle-visible="" data-model="{{model}}" data-id="{{itemId|ObjectKey:list.data}}" >-->
        <label class="switch" data-atom-toggle-visible="" data-model="{{model}}" data-id="{{itemId}}">
          <input type="checkbox" data-ng-model="item.enabled" ng-change="setEdited(item)">
          <i class="slim"></i>
        </label>
      </td>
      <td class="action-td">
        <a tooltip="Просмотр и редактирование элемента" tooltip-placement="left" tooltip-append-to-body="true"  class="btn-icon btn-icon-min-sm btn-edit" href="#/{{model}}/edit/{{item._id['$id']}}">
          <i ng-if="editEnabled" class="glyphicon glyphicon-pencil"></i>
          <i ng-if="!editEnabled" class="fa fa-th-list"></i>
        </a>
        <!--<a class="btn-icon btn-icon-min-sm btn-remove cursor-pointer" data-rem-id="{{itemId|ObjectKey:list.data}}" data-ng-click="delete($event);">-->
        <a tooltip="Удалить элемент" tooltip-placement="left" tooltip-append-to-body="left"  ng-show="deleteEnabled" class="btn-icon btn-icon-min-sm btn-remove cursor-pointer" data-rem-id="{{itemId}}"
           data-ng-click="deleteStack(item._id['$id']);">
          <i class="glyphicon glyphicon-trash"></i>
        </a>
      </td>

    </tr>
    </tbody>
  </table>
</div>


    <atom-pagination></atom-pagination>
  </section>
  <div data-ng-hide="renderData" class="form-group refresh-position">
    <div class="col-md-12 text-center">
      <span style="font-size: 24px" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
    </div>
  </div>
</div>
