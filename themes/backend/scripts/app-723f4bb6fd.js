function UrlMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><div class="input-group"><span class="input-group-addon">{{form.'+e.name+".urlPrefix}}</span><input "+t+n+' id="'+e.name+'"  type="text" class="form-control" data-ng-model="form.'+e.name+'.displayUrl"></div></div>',callback:function(e){return!0}}}function TextareaMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return e.placeholder=e.placeholder?e.placeholder:"",{markup:'<label for="textarea-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><textarea '+t+n+' id="textarea-'+e.name+'" class="form-control" rows="4" placeholder="'+e.placeholder+'" data-ng-model="form.'+e.name+'"></textarea></div>',callback:function(e){return!0}}}function TextMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return e.placeholder=e.placeholder||"",{markup:'<label for="text-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><textarea '+t+n+' autocomplete="off" id="text-'+e.name+'" placeholder="'+e.placeholder+'" class="form-control" rows="4" data-ng-model="form.'+e.name+'"></textarea></div>',callback:function(e){return!0}}}function StringMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" readonly ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return e.placeholder=e.placeholder?e.placeholder:"",{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><input '+t+n+' autocomplete="off" id="'+e.name+'" placeholder="'+e.placeholder+'" type="text" class="form-control" data-ng-model="form.'+e.name+'"></div>',callback:function(e){return!0}}}function SpeedMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="select-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><span ><select '+t+' class="chosen-select" data-ng-options="o for  o in speedList" data-ng-model="form.'+e.name+'"></select></span></div>',callback:function(e){return setTimeout(function(){jQuery(".chosen-select").chosen({})},500),!0}}}function SlidesMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:['<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+"</label>",'<div class="col-sm-10 slides-item" data-ng-class="{\'pull-right\': $index > 0}" data-ng-repeat="tileSlid in form.'+e.name+'">',"<input "+t+' type="file" data-index="{{$index}}" title="Выберите файл"   onchange="angular.element(this).scope().changeFile(this)"  data-file-upload class="btn-primary" data-ng-model="tileSlid.path">','<img class="image-link" data-ng-if="tileSlid.route" style="width:30px; margin-left: 18px;" data-ng-src="{{tileSlid.route}}"/>','<img class="image-link" data-ng-if="!tileSlid.route" style="width:30px; margin-left: 18px;" data-ng-src="http://placehold.it/30x30"/>','<label  title="Видимость" class="switch" style="position: relative; top: 10px; left: 10px; margin-right: 10px;"><input data-ng-model="tileSlid.status"  type="checkbox" ><i></i></label>','<a data-ng-hide="$first" data-ng-click="remTileSlide($index);" title="Удалить" href="javascript:;" style="margin-left: 10px;" class="btn-icon btn-icon-sm bg-danger"><i class="glyphicon glyphicon-minus"></i></a>','<a data-ng-show="$last" data-ng-click="addTileSlide();" title="Добавить" href="javascript:;" style="margin-left: 10px; " class="btn-icon btn-icon-sm bg-info"><i class="glyphicon glyphicon-plus"></i></a>',"</div>"].join(""),callback:function(e){return!0}}}function SelectMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?"disabled":"";return{markup:'<label for="select-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><select '+t+' chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" ng-options="option.name for option in  optionsData.'+e.name+'.options " id="select-'+e.name+'.val" ng-model="form.'+e.name+'"></select></div>',callback:function(e){return setTimeout(function(){"disabled"===t&&jQuery(e).find("[chosen]").prop("disabled",!0).trigger("chosen:updated")},500),!0}}}function PasswordMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><atom-password ><div class="input-group"><input '+t+n+' id="'+e.name+'"  autocomplete="off" type="{{atomPassword.type}}" class="form-control" data-ng-model="form.'+e.name+'"><span class="input-group-addon" ng-click="atomPassword.generatePassword()"><i class="glyphicon glyphicon-flash"></i></span></div></atom-password></div>',callback:function(e){return!0}}}function NumericMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return e.placeholder=e.placeholder?e.placeholder:"",{markup:'<label for="number-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><input '+t+n+' id="number-'+e.name+'" placeholder="'+e.placeholder+'"  data-ng-model="form.'+e.name+'"  type="number" class="form-control"></div>',callback:function(e){return e=e.find(".input-group"),e.find(".input-group-btn  button").click(function(){setTimeout(function(){e.find("input.spinner-input").trigger("change")},300)}),!0}}}function MarkupFactory(e){if(e){"datetime"!==e&&"time"!==e||(e="date"),e=e.split("-"),angular.forEach(e,function(t,n){var i=t.charAt(0).toUpperCase();e[n]=i+t.substr(1,t.length-1)});var t=e.join("")+"Markup";return t}}function IntegerMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return{markup:'<label for="number-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><input '+t+n+' id="number-'+e.name+'" data-ng-model="form.'+e.name+'"  type="number" class="form-control"></div>',callback:function(e){return e=e.find(".input-group"),e.find(".input-group-btn  button").click(function(){setTimeout(function(){e.find("input.spinner-input").trigger("change")},300)}),!0}}}function ImgMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><input '+t+' id="'+e.name+'" type="file" title="Выберите файл"   onchange="angular.element(this).scope().changeFile(this)"  data-file-upload class="btn-primary" data-ng-model="form.'+e.name+'"><img class="image-link" data-ng-if="form.'+e.name+'" style="height:30px; margin-left: 18px;" data-ng-src="{{form.'+e.name+'}}"/></div>',callback:function(e){return!0}}}function ImageMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10" atom-file><input '+t+' id="'+e.name+'" name="'+e.name+'" type="file" title="Выберите файл"  class="ng-hide"><a class="file-input-wrapper btn btn-default  btn-primary" ><span>Выберите файл</span></a><img class="image-link" data-ng-if="form.'+e.name+'[0].route" style="height:30px; margin-left: 18px;" ng-click="openLightboxModal($event)" data-ng-src="{{form.'+e.name+'[0].route}}"/></div>',callback:function(e){return!0}}}function HtmlMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled?" disabled ":" ",n="undefined"!=typeof e.readonly&&1==e.readonly?" readonly ":" ";return{markup:'<label for="textarea-'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><textarea '+t+n+' id="textarea-'+e.name+'" data-ui-tinymce class="form-control" rows="4" data-ng-model="form.'+e.name+'"></textarea></div>',callback:function(e){return!0}}}function FileMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10" atom-file><input data-file-upload '+t+' id="'+e.name+'" ng-model="form.'+e.name+'" name="'+e.name+'" type="file" title="Выберите файл"  class="ng-hide"><a class="file-input-wrapper btn btn-default  btn-primary" ><span>Выберите файл</span></a></div>',callback:function(e){return!0}}}function EntityMarkup(e){var t=e.multiple===!0?" multiple ":" ",n="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?"disabled":" ";return{markup:'<div class="col-sm-2"><label for="select-'+e.name+'" style="margin-top: 7px;">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+"</label><a ng-if=\"selectedEntity('"+e.name+'\')" href="javascript:void(0)" ng-click="openEntity(\''+e.name+"',"+e.multiple+')" ><i  tooltip="Открыть в новом окне связанные элементы" tooltip-placement="top" tooltip-append-to-body="true" class="fa fa-share entity-link '+t+'" style="margin-top: 7px;"></i></a></div><div class="col-sm-10"><span ><select '+n+' chosen="{disableSearch: true}" disable-search no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" class="form-control"  '+t+' entity-markup ng-options="option as option.name for option in  ::options track by option.id" id="select-'+e.name+'.val" ng-model="form.'+e.name+'"></select></span></div>',callback:function(e){return setTimeout(function(){"disabled"===n&&jQuery(e).find("[chosen]").prop("disabled",!0).trigger("chosen:updated")},500),!0}}}function DateMarkup(e){"undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:['<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+"</label>",'<div class="input-group col-sm-4" style="padding: 0 15px;" m-model="form.'+e.name+'.sec" ng-model="form.'+e.name+'.sec" atom-datetimepicker language="ru" form="form" data-data-type="'+e.type+'" data-data-name="'+e.name+'" >',"</div>"].join(""),callback:function(e){return!0}}}function BooleanMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><label class="switch"><input '+t+' id="'+e.name+'"  type="checkbox" data-ng-model="form.'+e.name+'" ><i></i></label></div>',callback:function(e){return!0}}}function AclMarkup(e){var t="undefined"!=typeof e.disabled&&1==e.disabled||e.readonly?" disabled ":" ";return{markup:'<label for="'+e.name+'" class="col-sm-2">'+e.title+(e.require?'<span class="require" style="padding-left: 3px;">*</span>':"")+'</label><div class="col-sm-10"><div class="table-responsive"><table class="table table-striped table-bordered" acl-markup'+t+'><thead><tr><th>#</th><th width="15%">Чтение</th><th width="15%">Создание</th><th width="15%">Редактирование</th><th width="15%">Удаление</th></tr></thead><tbody><tr ng-repeat="option in optionsData.'+e.name+'.options"><td>{{option.title}}</td><td><label class="switch"><input id="read_{{ option.key }}"  type="checkbox" data-ng-model="option.read" ><i></i></label></td><td><label class="switch" ng-show="option.key != \'index\' && option.key != \'atom\'"><input id="create_{{ option.key }}"  type="checkbox" data-ng-model="option.create" ><i></i></label></td><td><label class="switch" ng-show="option.key != \'index\' && option.key != \'atom\'"><input id="update_{{ option.key }}"  type="checkbox" data-ng-model="option.update" ><i></i></label></td><td><label class="switch" ng-show="option.key != \'index\' && option.key != \'atom\'"><input id="delete_{{ option.key }}"  type="checkbox" data-ng-model="option.delete" ><i></i></label></td></tr></tbody></table></div></div>',callback:function(e){return!0}}}!function(){"use strict";angular.module("entityPage",[]).config(["$stateProvider",function(e){e.state("pagesList",{url:"/page/list",views:{"content@":{templateUrl:"app/modules/entityPage/pagesList/pagesList.html",controller:"PagesListCtrl"}}}).state("entitiesList",{url:"/:entity/list",views:{"content@":{templateUrl:"app/modules/entityPage/entitiesList/entitiesList.html",controller:"EntitiesListCtrl"}}}).state("entityEdit",{url:"/:entity/edit/:id",views:{"content@":{templateUrl:"app/modules/entityPage/entityEdit/entityEdit.html",controller:"EntityEditCtrl"}}}).state("entityAdd",{url:"/:entity/add",views:{"content@":{templateUrl:"app/modules/entityPage/entityEdit/entityEdit.html",controller:"EntityEditCtrl"}}}).state("entityAddPage",{url:"/:entity/add/:pid",views:{"content@":{templateUrl:"app/modules/entityPage/entityEdit/entityEdit.html",controller:"EntityEditCtrl"}}})}])}(),function(){"use strict";angular.module("entityPage").controller("PagesListCtrl",["$q","$log","$scope","$stateParams","$state","$location","EntityService","$uibModal","toastr","_",function(e,t,n,i,a,o,s,l,r,c){function d(e,t,n){return c.each(e,function(t){if(0!==t._id.$id){var n="undefined"!=typeof t.pid.$id?t.pid.$id:t.pid;e[n].items.push(t),e[n].items.sort(function(e,t){return e.position-t.position})}}),t}var u={};n.list=[];var p=[];n.options={dropped:function(t){function i(e){c.each(e.items,function(t){var n=t.url.split("/");t.url=e.url+n[n.length-2],a.push({_id:t._id.$id,position:t.position,pid:t.pid.$id,url:t.url}),i(t)})}var a=[],o=[],l=t.source.nodeScope.$modelValue,d=t.dest.index,m=t.source.index,g=t.dest.nodesScope.$nodeScope.$modelValue,f=t.source.nodesScope.$nodeScope.$modelValue;if(d!==m||g._id.$id!==f._id.$id){var h;h=0===l.pid?0:l.pid.$id,c.each(u[h].items,function(e){o.push({_id:e._id.$id,position:e.position,pid:e.pid.$id,url:e.url})}),l.pid=g._id,c.each(u[l.pid.$id].items,function(e,t){o.push({_id:e._id.$id,position:e.position,pid:e.pid.$id,url:e.url}),e.position=t;var n=e.url.split("/");e.url=g.url+n[n.length-2]+"/",a.push({_id:e._id.$id,position:e.position,pid:e.pid.$id,url:e.url}),i(e)});var y=[];c.each(a,function(e){y.push(s.saveEntity("page",e,!1,!1))}),e.all(y).then(function(e){var t=!0;c.each(e,function(e){t=t||e.data.success}),t&&(r.success("Изменения успешно сохранены"),p=c.clone(n.data))},function(t){c.each(t.data.error,function(e){c.each(e,function(e){r.error(e.message)})});var i=[];c.each(o,function(e){i.push(s.saveEntity("page",e,!1,!1))}),e.all(i).then(function(e){n.data=p})})}}},s.getEntityDescription("page").then(function(e){s.getEntityPage("page",0,0).then(function(t){c.each(t.data.data,function(e){e.items=[],u[e._id.$id]=e});var i={_id:{$id:0},items:[],title:o.host(),url:"/",isRoot:!0};u[0]=i,i=d(u,i,0),n.data=[i],p=c.clone(n.data),n.list.scheme=e.data.page.scheme})}),n.removeItem=function(e,t){var n=e._id.$id,i=e.title,a=l.open({templateUrl:"app/components/popup/popup.html",controller:["$scope",function(o){o.title=i,o.message="Вы действительно хотите удалить данный элемент?",o.ok=function(){a.close(),s.removeEntity("page",{_id:n}).then(function(){r.success("Запись успешно удалена")}),t(e)},o.cancel=function(){a.dismiss("cancel")}}]})},n.toggle=function(e){e.collapsed=!e.collapsed},n.hoverIn=function(){this.hovered=!0},n.hoverOut=function(){this.hovered=!1}}])}(),function(){"use strict";angular.module("entityPage").controller("EntityEditCtrl",["$scope","$state","$stateParams","$uibModal","$window","$q","$timeout","EntityService","AuthService","_","uiTinymceConfig","toastr","$cookies",function(e,t,n,i,a,o,s,l,r,c,d,u,p){function m(){0!==angular.element(".mce-container.mce-panel.mce-floatpanel.mce-window.mce-in:eq(1)").length&&s(function(){var e=angular.element(window).width()-30;e>1270&&(e=1270),angular.element(".mce-container.mce-panel.mce-floatpanel.mce-window.mce-in:eq(1)").css("width",e).css("left",15),angular.element(".mce-container-body.mce-window-body.mce-abs-layout:eq(1)").css("width","100%")},250)}var g={};e.form={},e.entity=n.entity,e.isNew=!n.id,e.itemTitle="",a.jQuery.ajaxSetup({beforeSend:function(e){e.setRequestHeader("Token",p.get("token"))}}),d=c.extend(d,{height:300,menubar:!1,language:"ru",plugins:["code,table advlist autolink link image lists charmap print preview hr anchor pagebreak ","searchreplace wordcount visualblocks visualchars insertdatetime media nonbreaking"," contextmenu directionality emoticons paste textcolor responsivefilemanager"],convert_urls:!1,relative_urls:!0,toolbar1:"formatselect | bold italic underline | alignleft aligncenter alignright alignjustify | outdent indent | bullist numlist | table | styleselect| link unlink filemanager | image media | code ",valid_elements:"*[*]",image_advtab:!0,external_filemanager_path:"/atom/filemanager/",external_plugins:{filemanager:"/themes/backend/filemanager/plugin.min.js"},filemanager_title:"Файловый менеджер"}),angular.element(window).resize(m),o.all([r.properties(),l.getEntityDescription(n.entity)]).then(function(t){function i(){var t="undefined"==typeof e.backend.tabs.main?"default":"main";return"default"===t&&(e.backend.tabs[t]="Основное",r[t]="Основное"),t}var a=t[1],o=t[0].data.entities[n.entity];e.updateEnabled="undefined"!=typeof a.data[n.entity].routes[n.entity+".update"],e.deleteEnabled="undefined"!=typeof a.data[n.entity].routes[n.entity+".delete"];var s=a.data[n.entity].scheme;e.backend={},e.backend.tabs=o.tabs||{};var r={};c.each(s,function(t){"undefined"==typeof t.tab&&(t.tab=i()),"undefined"==typeof e.backend.tabs[t.tab]&&(e.backend.tabs[t.tab]=t.tab)}),c.each(e.backend.tabs,function(t,n){c.each(s,function(t){t.tab===n&&(r[t.tab]=e.backend.tabs[t.tab])})}),e.tabsCount=c.keys(r).length,e.tabs=r,n.id?l.getEntity(n.entity,n.id).then(function(t){e.form={},e.optionsData={},c.each(s,function(n,i){"select"==n.type||"entity"==n.type||"acl"==n.type?(e.optionsData[i]=n,e.optionsData[i].options=[],e.form[i]=n.multiple?[]:null,"select"==n.type?c.each(n.values,function(a,o){var s={name:a,id:o};e.optionsData[i].options.push(s),o==t.data.data[0][i]&&(n.multiple?e.form[i].push(s):e.form[i]=s)}):e.optionsData[i].sourceValues=t.data.data[0][i]):e.form[i]=t.data.data[0][i],n.name=i}),e.formSchema=s,c.each(e.formSchema,function(n,i){if("undefined"==typeof e.form[i]?e.form[i]=n["default"]:"undefined"==typeof e.form[i]&&"select"==n.type&&c.each(n.values,function(a,o){var s={name:a,id:o};e.optionsData[i].options.push(s),o==t.data.data[0][i]&&(n.multiple?e.form[i].push(s):e.form[i]=s)}),"url"==n.type){var a=e.form[i],o=(e.form.title,a.split("/")),s=a.substring(0,a.length-o[o.length-2].length-1),l=o[o.length-2];e.form[i]={urlPrefix:s,displayUrl:l}}}),g=c.clone(e.form),e.itemTitle=e.form.title}):(e.optionsData={},c.each(s,function(t,n){"boolean"===t.type?"undefined"!=typeof t["default"]?e.form[n]=t["default"]:e.form[n]=!1:"entity"===t.type||"select"===t.type||"acl"==t.type?(e.optionsData[n]=t,e.optionsData[n].options=[],e.optionsData[n].sourceValues={},e.form[n]=t.multiple?[]:null,"select"==t.type&&c.each(t.values,function(i,a){var o={name:i,id:a};e.optionsData[n].options.push(o),o.id==t["default"]&&(t.multiple?e.form[n].push(o):e.form[n]=o)})):"undefined"==typeof t["default"]?e.form[n]=null:e.form[n]=t["default"],t.name=n}),n.pid?"0"===n.pid?(e.form.url={urlPrefix:"/",displayUrl:""},e.optionsData.pid=s.pid,e.optionsData.pid.sourceValues={$id:"0"},e.formSchema=s,g=c.clone(e.form)):l.getEntity(n.entity,n.pid).then(function(t){e.form.url={urlPrefix:t.data.data[0].url,displayUrl:""},e.optionsData.pid=s.pid,e.optionsData.pid.sourceValues=t.data.data[0]._id,e.formSchema=s,g=c.clone(e.form)}):(e.formSchema=s,g=c.clone(e.form)))}),e.save=function(t){n.id&&(e.form._id=n.id);var i={},o=!!c.findWhere(e.formSchema,{type:"image"})||!!c.findWhere(e.formSchema,{type:"file"}),s=new a.FormData;c.each(e.form,function(t,n){("_id"==n||"undefined"!=typeof t&&null!==t||"acl"===e.formSchema[n].type)&&("_id"==n||"entity"!=e.formSchema[n].type&&"select"!=e.formSchema[n].type?"_id"!=n&&"acl"==e.formSchema[n].type?c.each(e.formSchema[n].options,function(e,t){i[n+"["+e.key+"][read]"]=e.read||!1,i[n+"["+e.key+"][create]"]=e.create||!1,i[n+"["+e.key+"][update]"]=e.update||!1,i[n+"["+e.key+"][delete]"]=e["delete"]||!1}):"_id"!=n&&"image"==e.formSchema[n].type?t&&t.updateFile&&s.append(n,t):"_id"!=n&&"file"==e.formSchema[n].type?t&&t.updateFile&&s.append(n,t):"_id"!=n&&"url"==e.formSchema[n].type?(t=e.form[n].urlPrefix+e.form[n].displayUrl+"/",i[n]=t,s.append(n,t)):(i[n]=t,s.append(n,t)):e.formSchema[n].multiple?c.each(t,function(e,t){i[n+"["+t+"]"]=e.id,s.append(n+"["+t+"]",e.id)}):t&&"undefined"!=typeof t.id&&(s.append(n,t.id),i[n]=t.id))}),l.saveEntity(n.entity,o?s:i,e.isNew,o).then(function(n){n.data.success&&(u.success("Запись успешно сохранена"),t?e.goToList():e.goToEdit(c.keys(n.data.success[0])))},function(e){c.each(e.data.error,function(e){c.each(e,function(e){u.error(e.message)})})})},e.remove=function(){var a=e.form.title||null,o=i.open({templateUrl:"app/components/popup/popup.html",controller:["$scope",function(e){e.title=a,e.message="Вы действительно хотите удалить данный элемент?",e.ok=function(){o.close(),l.removeEntity(n.entity,{_id:n.id}).then(function(){u.success("Запись успешно удалена"),t.go("entitiesList",{entity:n.entity})})},e.cancel=function(){o.dismiss("cancel")}}]})},e.clear=function(){for(var t in e.form)e.form[t]=null},e.rollback=function(){e.form=c.clone(g)},e.goToList=function(){t.go("page"===n.entity?"pagesList":"entitiesList",{entity:n.entity})},e.goToEdit=function(e){t.go("entityEdit",{entity:n.entity,id:e})},e.openEntity=function(n,i){var o=e.form[n];if(0!==o.length){var s;void 0===i||0==i?(s=t.href("entityEdit",{entity:e.formSchema[n].entity.model,id:o.id},{absolute:!1}),a.open(location.origin+location.pathname+s)):c.each(o,function(i){s=t.href("entityEdit",{entity:e.formSchema[n].entity.model,id:i.id},{absolute:!1}),a.open(location.origin+location.pathname+s)})}},e.selectedEntity=function(t){return null!==e.form[t]&&0!=e.form[t].length}}])}(),function(){"use strict";angular.module("entityPage").controller("EntitiesListCtrl",["$log","$q","$scope","$stateParams","$state","$timeout","EntityService","$uibModal","toastr","_","SessionService","deviceDetector",function(e,t,n,i,a,o,s,l,r,c,d,u){function p(){o(function(){var e=!1;e="safari"==u.browser?angular.element("#content div.panel-body").outerWidth()>angular.element("section.table-flip-scroll").width():angular.element("#content table").width()>angular.element("section.table-flip-scroll").width(),e&&(angular.element("section.panel div.panel-body").css("max-height",angular.element(window).height()-(angular.element("#header").height()+(angular.element("div.page").innerHeight()-angular.element("div.page").height()-110)+angular.element("div.panel-heading").outerHeight(!0)+angular.element("div.table-filters").outerHeight(!0)+angular.element("footer.table-footer").outerHeight(!0))+"px"),angular.element("section.panel div.panel-body").css("overflow-y","auto"))},500)}if("page"==i.entity)return void a.go("pagesList");var m=d.getEntityListState(i.entity)||{};n.$log=e,n.list={},n.model=i.entity,n.remList=[],n.linkedEntities={},n.fieldsInTable={};var g={},f=[],h=!1,y=[],v={},b=[];n.curSortField=m.curSortField,n.curSortOrder=m.curSortOrder,n.searchKeywords=m.searchKeywords,n.hasSearchFields=!1,n.order=function(e,t){n.curSortField=e,n.curSortOrder=t,f=[],n.remList=[],m.curSortField=e,m.curSortOrder=t,d.setEntityListState(m,i.entity),n.displayData(0,n.perPage,n.curSortField,n.curSortOrder,n.searchKeywords)},s.getEntityDescription(i.entity).then(function(e){n.exportEnabled="undefined"!=typeof e.data[i.entity].routes[i.entity+".export"],n.createEnabled="undefined"!=typeof e.data[i.entity].routes[i.entity+".create"],n.deleteEnabled="undefined"!=typeof e.data[i.entity].routes[i.entity+".delete"],n.editEnabled="undefined"!=typeof e.data[i.entity].routes[i.entity+".update"],n.graphicsEnabled="undefined"!=typeof e.data[i.entity].atomgraphics,n.list.scheme=e.data[i.entity].scheme;for(var t in n.list.scheme)n.list.scheme[t].sort&&(b.push(t),"enabled"!==t&&(n.fieldsInTable[t]=n.list.scheme[t])),n.list.scheme[t].search&&(n.hasSearchFields=!0),"entity"==n.list.scheme[t].type&&n.list.scheme[t].sort&&(y[t]=[],v[t]=n.list.scheme[t].entity&&n.list.scheme[t].entity.model?n.list.scheme[t].entity.model:t,g[t]=n.list.scheme[t].entity||{})}),n.displayData=function(e,a,o,l,r){n.renderData=null,s.getEntityPage(i.entity,e,a,o,l,r,b).then(function(e){if(h=!1,204!=e.status){for(var i=[],a=0;a<e.data.data.length;a++)i.push(e.data.data[a]);c.each(e.data.data,function(e){c.each(c.keys(y),function(t){"undefined"!=typeof e[t]&&y[t].push(e[t])})});var o=[],l=[];c.each(c.keys(y),function(e){if("pid"!=e){var t=s.getLinkedEntities(v[e],g[e].field,c.uniq(y[e]));o=o.concat(t);for(var n=0;n<t.length;n++)l.push(e)}}),t.all(o).then(function(t){t=c.zip(t,l);var a=[];c.each(t,function(e){a[e[1]]&&a[e[1]][0].data.data?a[e[1]][0].data.data=a[e[1]][0].data.data.concat(e[0].data.data):a[e[1]]=e}),t=[];for(var o in a)t.push(a[o]);c.each(t,function(e){n.linkedEntities[e[1]]=[];var t=c.compact(e[0].data.data);c.each(t,function(t){n.linkedEntities[e[1]].push({$id:t._id.$id,title:g[e[1]]?t[g[e[1]].field]:t.title})})}),n.last={row:!1,col:!1},n.renderData=i,n.$broadcast("dataCountReady",e.data.total)}),0==c.keys(y).length&&(n.renderData=i)}else n.renderData=[],n.$broadcast("dataCountReady",0)})},n.$on("dataCountReady",p),angular.element(window).resize(p),n["new"]=function(){a.go("entityAdd",{entity:n.model})},n.setEdited=function(e){s.saveEntity(i.entity,{_id:e._id.$id,enabled:e.enabled}).then(function(e){e.data.success&&r.success("Запись сохранена")})},n.selectAllItems=function(e){n.remList=[];var t=angular.element(e.currentTarget),i=t.closest("table");i.find('tbody input[type="checkbox"].remBox').prop("checked",t.is(":checked")),1==e.currentTarget.checked?angular.forEach(i.find('tbody input[type="checkbox"].remBox'),function(e){n.remList.push(e.value)}):n.remList=[],f=n.remList},n.updateRemItems=function(e){if(e.currentTarget.checked===!1){var t=c.indexOf(n.remList,e.currentTarget.value);t>-1&&n.remList.splice(t,1)}else n.remList.push(e.currentTarget.value);f=n.remList},n.isSelectItems=function(){return 0===n.remList.length},n.exportStack=function(){s.exportEntity(i.entity,f,n.curSortField,n.curSortOrder,n.searchKeywords)},n.deleteStack=function(e){var t=n.renderData,o=l.open({templateUrl:"app/components/popup/popup.html",controller:["$scope",function(n){var l=e?[e]:f;if(l.length>1)n.title="Всего выбрано элементов: "+l.length;else{var d=c.find(t,function(e){return e._id.$id==l[0]});n.title=d.title||null}n.message=l.length>1?"Вы действительно хотите удалить данные элементы?":"Вы действительно хотите удалить данный элемент?",n.ok=function(){o.close(),c.each(l,function(e){s.removeEntity(i.entity,{_id:e}).then(function(){r.success("Запись успешно удалена"),a.transitionTo(a.current,i,{reload:!0,inherit:!1,notify:!0})})})},n.cancel=function(){o.dismiss("cancel")}}]})},n.search=function(){m.searchKeywords=n.searchKeywords,d.setEntityListState(m,i.entity),n.displayData(0,n.perPage,n.curSortField,n.curSortOrder,n.searchKeywords)},n.keyUpHandler=function(e){13===e.keyCode&&n.search()},n.goToGraphic=function(){f&&d.saveSelectedItems(f),a.go("infographic",{entity:i.entity})}}])}(),function(){"use strict";angular.module("directives.atomFields",[])}(),function(){"use strict";angular.module("directives.atomFields").directive("atomForm",function(){return{restrict:"A",controller:["$scope",function(e){e.$on("atom:changeField",function(t,n){t.stopPropagation(),e.$broadcast("atom:broadcast:changeField",n)})}]}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldString",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFields/atomFieldString/atomFieldString.html"}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldSelect",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"=",linkedEntity:"=",entityModel:"="},templateUrl:"app/directives/atomFields/atomFieldSelect/atomFieldSelect.html",link:function(e){var t=Lazy(e.scheme.values).map(function(e,t){return{title:e,id:t}}).toArray(),n=e.scheme.multiple?e.field:[e.field],i=Lazy(n).compact().map(function(e){return Lazy(t).find(function(t){return t.id===e.$id})}).compact().toArray();e.list=t,e.entityModel[e.fieldName]=e.scheme.multiple?i:i[0]}}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldPassword",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFields/atomFieldPassword/atomFieldPassword.html"}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldEntity",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"=",linkedEntity:"=",entityModel:"="},templateUrl:"app/directives/atomFields/atomFieldEntity/atomFieldEntity.html",link:function(e){function t(){function t(t){var n=[];return Lazy(t).each(function(t){n=r.concat(Lazy(e.entityModel[t]).map(function(e){return{name:t,id:e.id}}).toArray())}),n}function a(){return l&&l.length&&r.length}function o(){return Lazy(n).map(function(e){var t=Lazy(r).find(function(t){return e[t.name].$id===t.id});return t?{title:e[i],id:e._id.$id}:void 0}).compact().toArray()}function s(){return Lazy(n).map(function(e){return{title:e[i],id:e._id.$id}}).toArray()}var l=e.scheme.related,r=[];return l&&(r=t(l)),a()?o():s()}var n=e.linkedEntity.data.data;e.entityModel[e.fieldName]=e.entityModel[e.fieldName]||[];var i=e.scheme.entity.field?e.scheme.entity.field:"",a=t(),o=e.scheme.multiple?e.field:[e.field],s=Lazy(o).map(function(e){return Lazy(a).find(function(t){return t.id===e.$id})}).compact().toArray();e.entityModel[e.fieldName]=e.scheme.multiple?s:s[0],e.list=a,e.triggerEvent=function(){e.$emit("atom:changeField",{fieldName:e.fieldName})},e.$on("atom:broadcast:changeField",function(n,i){if(i.fieldName===e.fieldName)return!1;var a=i.fieldName,o=e.scheme.related;o&&-1!==o.indexOf(a)&&(e.list=t())})}}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldDatetime",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFields/atomFieldDatetime/atomFieldDatetime.html",link:function(e,t){var n="time"===e.scheme.type?"HH:mm":"date"===e.scheme.type?"DD.MM.YYYY":"DD.MM.YYYY HH:mm";e.today=function(){return e.dt=new Date,e.dt};var i=e.field?e.field.sec:0;i&&(e.dt=moment(1e3*i)),angular.element(t[0].querySelector("input")).datetimepicker({
locale:"ru",useCurrent:!0,defaultDate:e.dt,format:n,extraFormats:[n]}),t.find("input").on("blur",function(){var i=moment(t.find("input").val(),n);e.field=i.locale("en").format("ddd MMM DD YYYY HH:mm:ss"),t.find("input").trigger("input")})}}})}(),function(){"use strict";angular.module("directives.atomFields").directive("atomFieldBoolean",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFields/atomFieldBoolean/atomFieldBoolean.html"}})}(),function(){"use strict";angular.module("rest.infographic",[]).config(["$provide",function(e){e.decorator("InfographicAPIService",["$delegate","InfographicAPIServiceMock","debug",function(e,t,n){return n&&(e=t),e}])}])}(),function(){"use strict";angular.module("rest.infographic").service("InfographicAPIServiceMock",["$http",function(e){var t=this;t.getGraphicData=function(){return e.get("/app/rest/infographic/fixture/graphData.json")}}])}(),function(){"use strict";angular.module("rest.infographic").service("InfographicAPIService",["$http","$httpParamSerializer","baseURL","_",function(e,t,n,i){var a=this;a.getGraphicData=function(t){var i="";return t&&Lazy(t).each(function(e,t){angular.isUndefined(e)||(angular.isArray(e)?Lazy(e).each(function(e){i+="&condition["+t+"][$in][]="+e}):i+="&condition["+t+"]="+e)}),e.get(n+"/graphics/?"+i)}}])}(),function(){"use strict";angular.module("components.entity",[]).config(["$provide",function(e){e.decorator("EntityService",["$delegate","EntityServiceMock","debug",function(e,t,n){return n&&(e=t),e}])}])}(),function(){"use strict";angular.module("components.entity").service("EntityServiceMock",["$http","$httpParamSerializer",function(e,t){this.getEntities=function(){return e.get("/app/rest/entity/fixture/entities.json")},this.getEntitiesList=function(t){return e.get("/app/rest/entity/fixture/"+t+"List.json")},this.getEntityDescription=function(t){return e.get("/app/rest/entity/fixture/statisticsbybrandDescription.json")},this.getEntityPage=function(t,n,i){return 0===n?e.get("/app/rest/entity/fixture/usersPage1.json"):e.get("/app/rest/entity/fixture/usersPage2.json")},this.getEntity=function(t,n){return e.get("/app/rest/entity/fixture/userExample.json")},this.saveEntity=function(n,i){return e.get("/app/rest/entity/fixture/userSaved.json",t(i))},this.removeEntity=function(n,i){return e.get("/app/rest/entity/fixture/userSaved.json",t(i))}}])}(),function(){"use strict";angular.module("components.entity").service("EntityService",["$http","$httpParamSerializer","baseURL","_",function(e,t,n,i){var a=this;this.getEntities=function(t){var i=t?"?condition[name]="+t:"";return e.get(n+"/atom/entities/"+i)},this.getEntitiesList=function(t,i,a,o){i=i||0;var s=o?"&fields[]="+o:"",l="";if(angular.isObject(a))for(var r in a)l+="&sort["+r+"]="+a[r];return e.get(n+"/"+t+"/?condition[enabled][$ne]=null&limit="+i+l+s)},this.getEntityDescription=function(e){return a.getEntities(e)},this.getEntityPage=function(t,i,a,o,s,l,r){var c=o&&s?"&sort["+o+"]="+s:"",d=l?"&condition[$query]="+l+"&condition[ref_entity]="+t:"",u=r&&r.length?"&fields[]="+r.join("&fields[]="):"";return d?e.get(n+"/search/page/"+i+"/?condition[enabled][$ne]=null&limit="+a+c+u+d):e.get(n+"/"+t+"/page/"+i+"/?condition[enabled][$ne]=null&limit="+a+c+u)},this.getEntity=function(t,i){return e.get(n+"/"+t+"/"+i+"/")},this.saveEntity=function(i,a,o,s){var l="undefined"==typeof a._id&&o?"create":"update";return s?e.post(n+"/"+i+"/"+l+"/",a,{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":void 0,Accept:"application/json"}}):e.post(n+"/"+i+"/"+l+"/",t(a))},this.removeEntity=function(i,a){return e.post(n+"/"+i+"/delete/",t(a))},this.exportEntity=function(e,t,n,a,o){var s=[];if(t.length)for(var l=0;l<t.length;l++)s.push(angular.element('<input type="hidden" name="condition[_id][$in][]" value="'+t[l]+'">'));var r=angular.element("#downloadForm");r.html("");var c=angular.element('<input type="hidden" name="limit" value="0">'),d=n&&a?angular.element('<input type="hidden" name="sort['+n+']" value="'+a+'">'):"",u=o?angular.element('<input type="hidden" name="condition[$search]" value="'+o+'">'):"";i.each(s,function(e){r.append(e)}),r.append(c),r.append(d),r.append(u),r.attr({action:"/"+e+"/export/"})[0].submit()},this.getLinkedEntities=function(t,i,a){var o=[],s=[];if(a.length){var l,r;for(l=0,r=0;l<a.length;l++,r++)a[l]&&o.push("condition[_id][$in][]="+a[l].$id),19!=r&&l!=a.length-1||(o=o.join("&"),s.push(e.get(n+"/"+t+"/?"+o+"&limit=0")),r=-1,o=[])}return s}}])}(),function(){"use strict";angular.module("components.auth",[]).config(["$provide",function(e){e.decorator("AuthService",["$delegate","$location","AuthServiceMock","debug",function(e,t,n,i){return i&&(e=n),e}])}])}(),function(){"use strict";angular.module("components.auth").service("AuthServiceMock",["$http",function(e){this.logout=function(){return e.get("/app/rest/auth/fixture/logout_success.json")},this.login=function(t){var n=0===t.email.indexOf("test")?"auth.json":"auth_fail.json";return e.get("/app/rest/auth/fixture/"+n)},this.properties=function(){return e.get("/app/rest/auth/fixture/properties.json")}}])}(),function(){"use strict";angular.module("components.auth").service("AuthService",["$http","$httpParamSerializer","$q","baseURL",function(e,t,n,i){var a=this;a.cache={},this.logout=function(){return e.get(i+"/user/logout/")},this.login=function(n){return e.post(i+"/user/auth/pass/",t(n))},this.properties=function(){return a.cache.properties?n.when(a.cache.properties):e.get(i+"/atom/properties/").then(function(e){return a.cache.properties=e,e})}}])}(),function(){"use strict";angular.module("infographic",[]).config(["$stateProvider",function(e){e.state("infographic",{url:"/graphics/:entity",views:{"content@":{templateUrl:"app/modules/infographic/infographic.html",controller:"InfographicCtrl"}}})}])}(),function(){"use strict";angular.module("infographic").controller("InfographicCtrl",["$scope","$timeout","$stateParams","EntityService","HelperService","SessionService","AtomDiagramFactory","InfographicAPIService",function(e,t,n,i,a,o,s,l){function r(){return f&&f.length&&m}function c(){e.line1=s.line1,e.line1.options.xaxis.axisLabel=u,e.line1.options.yaxis.axisLabel=p}var d,u,p,m,g=n.entity,f=o.getSelectedItems();e.entity={},e.showGraph=!1,e.entityModels={},e.linkedEntities={},i.getEntityDescription(g).then(function(t){if(d=t.data[g].atomgraphics.controls,_.find(d,function(e,t){return e["default"]?(m=t,e):void 0}),r()){o.clearSelectedItems();var n=[];e.entityModels[m]=[],_.each(f,function(t){n.push({$id:t}),e.entityModels[m].push({id:t})}),e.entity[m]=n}return u=t.data[g].atomgraphics.axes.abscissa.title,p=t.data[g].atomgraphics.axes.ordinate.title,c(),a.getLinkedEntities(d)}).then(function(t){var n={};Lazy(t).each(function(e){n[e.entity]=e}),e.linkedEntities=n,e.scheme=d,d=null}).then(function(){r()&&e.getGiagram()}),e.getGiagram=function(){var t={entity:g};Lazy(e.scheme).each(function(n,i){switch(n.type){case"entity":Lazy(e.entityModels[i]).each(function(e,n){t[i]||(t[i]=[]),t[i].push(e.id)});break;case"select":t[i]=e.entityModels[i]?e.entityModels[i].id:void 0;break;default:t[i]=e.entity[i]}}),l.getGraphicData(t).then(function(t){var n=[];Lazy(t.data.data).each(function(e){var t=e.title;Lazy(e.data).each(function(e,i){n.push({data:e,label:t+" - "+i})})}),e.line1.data=n,e.showGraph=!0})}}])}(),function(){"use strict";angular.module("errorPage",[]).config(["$stateProvider",function(e){e.state("error500",{views:{"content@":{templateUrl:"app/modules/errorPage/500.html",controller:"ErrorPageCtrl"}}})}])}(),function(){"use strict";angular.module("errorPage").controller("ErrorPageCtrl",["$scope","$rootScope",function(e,t){t.hidePanels=!0,e.closeError=function(){t.hidePanels=!1}}])}(),function(){"use strict";angular.module("dashboard",["components.session","components.auth"]).config(["$stateProvider",function(e){e.state("dashboard",{url:"/",views:{"content@":{templateUrl:"app/modules/dashboard/dashboard.html",controller:"DashboardCtrl"}}})}])}(),function(){"use strict";angular.module("dashboard").controller("DashboardCtrl",["$state","$cookies","$rootScope",function(e,t,n){if(n.authorized){var i=t.get("homepage");e.go("entitiesList",{entity:i})}}])}(),function(){"use strict";angular.module("authorization",["components.session","components.auth"]).config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("login",{url:"/login",views:{"content@":{templateUrl:"app/modules/authorization/authorization.html",controller:"AuthorizationCtrl"}}}).state("logout",{url:"/logout",views:{"content@":{templateUrl:"app/modules/authorization/authorization.html",controller:"AuthorizationCtrl"}}})}])}(),function(){"use strict";angular.module("authorization").controller("AuthorizationCtrl",["$scope","$rootScope","$state","$document","$http","$cookies","AuthService","toastr","SessionService","$stateParams","loginPeriod",function(e,t,n,i,a,o,s,l,r,c,d){var u=31536e6;e.rememberMe=!0,n.is("logout")&&(t.hidePanels=!0,t.authorized=!1,void 0!==r.getSessionID()&&(r.setSessionID(void 0),o.remove("token"),o.remove("rememberMe"),s.logout()),n.go("login")),e.makeLogin=function(){s.login(e.user).then(function(e){return e.data.success?(a.defaults.headers.common.Token=e.data.success.user.token,s.properties().then(function(t){return{response:e,properties:t}})):void l.error(e.data.error.message)}).then(function(a){var s=a.response,c=a.properties.data.homepage,p=new Date,m={path:"/"};e.rememberMe?p.setTime(p.getTime()+u):p.setTime(p.getTime()+d),m.expires=p,r.setSessionID(s.data.success.user.token,p),r.setUserID(s.data.success.user._id.$id,p),l.success(s.data.success.message),i.find(".body-wide").removeClass("body-wide").removeClass("body-lock"),t.authorized=!0,t.hidePanels=!1,t.userName=s.data.success.user.name,o.put("token",s.data.success.user.token,m),o.put("homepage",c,m),o.put("rememberMe",e.rememberMe?1:0,m),n.go("entitiesList",{entity:c})})}}])}(),function(){"use strict";angular.module("directives.atomDiagram",[]).constant("moment",moment)}(),function(){"use strict";angular.module("directives.atomDiagram").factory("AtomDiagramFactory",["moment",function(e){var t=this;return t.line1={},t.line1.data=[{data:[],label:"Trend"}],t.line1.options={series:{shadowSize:0,lines:{show:!0,fill:!1,fillColor:{colors:[{opacity:0},{opacity:.3}]}},points:{show:!0,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle",radius:5}},tooltip:{show:!0,content:function(t,n,i){return"Date: "+e(1e3*n).format("DD MMMM YYYY")+" Total Hours: "+i},defaultTheme:!0},tooltipOpts:{defaultTheme:!1},grid:{hoverable:!0,clickable:!0,tickColor:"#f9f9f9",borderWidth:1,borderColor:"#eeeeee"},xaxis:{ticks:[]},yaxis:{},legend:{container:"#legend"}},t}])}(),function(){"use strict";angular.module("directives.atomDiagram").directive("atomFlotChart",[function(){return{restrict:"A",scope:{data:"=flotData",options:"=flotOptions"},link:function(e,t){var n,i,a;return n=e.data,i=e.options,e.$watch("data",function(){a.setData(e.data),a.setupGrid(),a.draw()},!0),a=$.plot(t[0],n,i)}}}])}(),function(){"use strict";angular.module("components.siteHeader",["components.session"])}(),function(){"use strict";angular.module("components.siteHeader").directive("siteHeader",["$state","SessionService",function(e,t){return{restrict:"EA",scope:!0,templateUrl:"app/components/siteHeader/siteHeader.html",controller:["$scope",function(n){n.notifications=0,n.ques=0,n.userName="Fake",n.showMenu=!1,n.isAuthorized=function(){return!!t.getSessionID()},n.goToSearch=function(){e.go("customerSearch")}}]}}])}(),function(){"use strict";angular.module("components.session",[]).value("Session",{})}(),function(){"use strict";angular.module("components.session").service("SessionService",["$cookies","Session",function(e,t){this.selectedItems,this.getUserID=function(){return e.get("userId")},this.setUserID=function(t,n){var i=new Date;return n=n||i.getTime()+108e5,i.setTime(n),e.put("userId",t,{expires:i})},this.setSessionID=function(t,n){var i=new Date;return n=n||i.getTime()+108e5,i.setTime(n),e.put("sessionId",t,{expires:i})},this.getSessionID=function(){return e.get("sessionId")},this.setEntityListState=function(t,n){return e.putObject("entity_"+n,t)},this.getEntityListState=function(t){return e.getObject("entity_"+t)},this.saveSelectedItems=function(e){this.selectedItems=e},this.getSelectedItems=function(){return this.selectedItems},this.clearSelectedItems=function(){this.selectedItems=null}}])}(),function(){"use strict";angular.module("components.popup",[])}(),function(){"use strict";angular.module("components.popup").directive("confirmDelete",function(){return{restrict:"EA",transclude:!0,scope:!0,templateUrl:"app/components/popup/popup.html",controller:["$scope",function(e){}]}})}(),function(){"use strict";angular.module("components.popup").controller("ModalRemoveCtrl",["$scope","$stateParams","$modalInstance",function(e,t,n){e.ok=function(){EntityService.removeEntity(t.entity,e.form),n.dismiss("cancel")},e.cancel=function(){n.dismiss("cancel")}}])}(),function(){"use strict";angular.module("components.pagination",[])}(),function(){"use strict";angular.module("components.pagination").directive("atomPagination",function(){return{restrict:"E",scope:!0,templateUrl:"app/components/pagination/pagination.html",controller:["$scope",function(e){e.scrollConfig={scrollX:"bottom",scrollY:"none",useBothWheelAxes:!0},e.numPerPageOpt=[{value:10,title:10},{value:20,title:20},{value:50,title:50},{value:100,title:100},{value:0,title:"Все"}],e.curPage=0,e.perPage=e.numPerPageOpt[2],e.$parent.perPage=e.perPage.value,e.pagesCount=0,e.itemsCount=0;e.$on("dataCountReady",function(t,n){e.itemsCount=n,e.pagesCount=e.perPage.value>0?Math.ceil(e.itemsCount/e.perPage.value):1,e.pagesCountList=e.pagesList(),e.pagesList(),e.$emit("content.changed")}),e.onNumPerPageChange=function(){e.curPage=0,e.$parent.perPage=e.perPage.value,e.pagesCount=e.perPage.value>0?Math.ceil(e.itemsCount/e.perPage.value):1,e.pagesCountList=e.pagesList(),e.displayData(e.curPage,e.perPage.value,e.curSortField,e.curSortOrder,e.searchKeywords)},e.goToPage=function(t){t>=0&&t<e.pagesCount&&(e.curPage=t,e.displayData(e.curPage,e.perPage.value,e.curSortField,e.curSortOrder,e.searchKeywords))},e.prevPage=function(t){return t?(e.goToPage(0),!1):void(e.curPage>0&&e.goToPage(e.curPage-1))},e.nextPage=function(t){return t?(e.goToPage(e.pagesCount-1),!1):void(e.curPage<e.pagesCount-1&&e.goToPage(e.curPage+1))},e.noPrevious=function(){return e.curPage<=0},e.noNext=function(){return e.curPage+1>=e.pagesCount},e.isActive=function(t){return e.curPage==t},e.pagesList=function(){var t=[];if(e.pagesCount>0)for(var n=1;n<=e.pagesCount;n++)t.push(n);return t.length?t:[1]},e.isInRange=function(t){e.pagesCount;return!0}}]}})}(),function(){"use strict";angular.module("components.navbar",["components.session"])}(),function(){"use strict";angular.module("components.navbar").directive("navbar",["SessionService",function(e){return{restrict:"EA",scope:!0,templateUrl:"app/components/navbar/navbar.html",controller:["$scope","$state","$element","AuthService",function(e,t,n,i){e.pages=[],n.find(".infoblockMenu ul").show(),i.properties().then(function(t){var n=_.clone(t.data.entities);e.pages=_.chain(n).each(function(e,t){e.entityName=t}).sortBy(function(e){return e.position}).value()})}]}}])}(),function(){"use strict";angular.module("components.helper",[])}(),function(){"use strict";angular.module("components.helper").service("HelperService",["$q","EntityService",function(e,t){var n=this;return n.stripTags=function(e){return e?e.toString().replace(/<\/?[^>]+>/gi,""):""},n.getLinkedEntities=function(n){var i=Lazy(n).map(function(e){return"entity"===e.type?t.getEntitiesList(e.entity.model,0,0).then(function(t){return{entity:e.entity.model,data:t.data}}):void 0}).compact().toArray();return e.all(i)},n}])}(),function(){"use strict";angular.module("components.collapseNav",[])}(),function(){"use strict";angular.module("components.collapseNav").directive("collapseNav",["SessionService",function(e){return{restrict:"A",link:function(e,t,n){var i,a,o,s,l,r,c,d,u,p;return c=$(window),s=t.find("ul").parent("li"),s.append('<i class="fa fa-angle-down icon-has-ul-h"></i><i class="fa fa-angle-right icon-has-ul"></i>'),i=s.children("a"),l=t.children("li").not(s),a=l.children("a"),o=$("#app"),r=$("#nav-container"),i.on("click",function(e){var t,n;return o.hasClass("nav-collapsed-min")||r.hasClass("nav-horizontal")&&c.width()>=768?!1:(n=$(this),t=n.parent("li"),s.not(t).removeClass("open").find("ul").slideUp(),t.toggleClass("open").find("ul").stop().slideToggle(),e.preventDefault())}),a.on("click",function(e){return s.removeClass("open").find("ul").slideUp()}),e.$on("nav:reset",function(e){return s.removeClass("open").find("ul").slideUp()}),d=void 0,u=c.width(),p=function(){var e;return e=c.width(),768>e&&o.removeClass("nav-collapsed-min"),768>u&&e>=768&&r.hasClass("nav-horizontal")&&s.removeClass("open").find("ul").slideUp(),u=e},c.resize(function(){return setTimeout(p,300)})}}}])}(),function(){"use strict";angular.module("components.buildFormMarkup",[])}(),function(){"use strict";angular.module("components.buildFormMarkup").directive("buildFormMarkup",["$compile",function(e){var t={restrict:"A",link:function(n,i,a){if(a.markupData){var o=JSON.parse(a.markupData);"true"==a.fieldReadonly&&(o.readonly=!0);var s=MarkupFactory(o.type);"function"==typeof window[s]&&(t=window[s](o))&&(i.html(e(t.markup)(n)),t.callback(i))}return!0}};return t}])}(),function(){"use strict";angular.module("components.atomPassword",[])}(),function(){"use strict";angular.module("components.atomPassword").directive("atomPassword",["SessionService",function(e){return{restrict:"AE",transclude:!0,template:"<span ng-transclude></span>",link:function(e){e.atomPassword={type:"password",generatePassword:function(){e.atomPassword.type="text",e.form[e.key]=Math.random().toString(36).slice(-8)}}}}}])}(),function(){"use strict";angular.module("components.atomFile",[])}(),function(){"use strict";angular.module("components.atomFile").directive("atomFile",["SessionService",function(e){return{restrict:"A",controller:["$scope","$element","Lightbox",function(e,t,n){t.find("a").click(function(e){t.find("input").trigger("click")}),t.find("input").change(function(){var n=t.find("input")[0].files;e.form[t.find("input").attr("name")]=n[0],e.form[t.find("input").attr("name")].updateFile=!0}),e.openLightboxModal=function(e){n.openModal([{url:e.target.src,caption:"",thumbUrl:""}],0)}}]}}])}(),function(){"use strict";angular.module("components.entityMarkup",[])}(),function(){"use strict";angular.module("components.entityMarkup").directive("entityMarkup",function(){return{restict:"AE",controller:["$scope","EntityService","_",function(e,t,n){e.optionsData[e.key].options=[];var i=[],a=e.field.entity.field||"title";t.getEntitiesList(e.optionsData[e.key].entity.model,null,e.optionsData[e.key].entity.sort,a).then(function(t){e.form[e.key]=[],n.each(t.data.data,function(t){var o={name:t[a],id:t._id.$id};i.push(o),e.optionsData[e.key].multiple?n.find(e.optionsData[e.key].sourceValues,function(e){return e.$id==o.id})&&e.form[e.key].push(o):(e.optionsData[e.key].sourceValues&&!n.isEmpty(e.optionsData[e.key].sourceValues)||!e.optionsData[e.key]["default"]||e.optionsData[e.key]["default"].$id!==o.id||(e.form[e.key]=o),e.optionsData[e.key].sourceValues&&e.optionsData[e.key].sourceValues.$id==o.id&&(e.form[e.key]=o))}),e.options=i})}]}})}(),function(){"use strict";angular.module("components.entityMarkup").directive("entityListMarkup",function(){return{restict:"AE",scope:{entity:"=",entityName:"=",field:"="},template:function(){return'<span ng-if="!file && !img" style="{white-space: nowrap}">{{::title}}</span><img ng-if="!file && img" ng-src="{{title}}" ng-click="openLightboxModal($event)"><a ng-if="file && !img" href="{{route}}">{{title}}</a>'},controller:["$scope","$filter","EntityService","Lightbox","HelperService",function(e,t,n,i,a){switch(e.field.type){case"date":e.title=e.entity?t("date")(1e3*e.entity.sec,"dd.MM.yyyy"):"";break;case"datetime":e.title=e.entity?t("date")(1e3*e.entity.sec,"dd.MM.yyyy HH:mm"):"";break;case"time":e.title=e.entity?t("date")(1e3*e.entity.sec,"HH:mm"):"";break;case"select":e.title=e.field.values[e.entity];break;case"entity":_.each(e.$parent.linkedEntities[e.entityName],function(t){t&&e.entity&&t.$id==e.entity.$id&&(e.title=t.title)});break;case"boolean":e.title=e.entity?"Да":"Нет";break;case"image":e.title=e.entity&&"undefined"!=typeof e.entity[0]?e.entity[0].route:"",e.img=!0;break;case"file":e.title=e.entity&&"undefined"!=typeof e.entity[0]?e.entity[0].title:"",e.route=e.entity&&"undefined"!=typeof e.entity[0]?e.entity[0].route:"",e.file=!0;break;default:e.title=a.stripTags(e.entity)}e.openLightboxModal=function(e){i.openModal([{url:e.target.src,caption:"",thumbUrl:""}],0)}}]}})}(),function(){"use strict";angular.module("components.atomDatetimepicker",[])}(),function(){"use strict";angular.module("components.atomDatetimepicker").directive("atomDatetimepicker",function(){return{restrict:"AEC",scope:{pick12HourFormat:"@",language:"@",useCurrent:"@",location:"@",mode:"@",form:"=",mModel:"=",dataName:"@dataName",dataType:"@dataType"},templateUrl:"app/components/atomDatetimepicker/atomDatetimepicker.html",link:function(e,t,n){function i(){var n=moment(t.find("input").val(),a);e.form[e.dataName]=n.toString().replace(/( \((.+)\))/g,""),t.find("input").trigger("input")}var a="time"===e.dataType?"HH:mm":"date"===e.dataType?"DD.MM.YYYY":"DD.MM.YYYY HH:mm";e.today=function(){return e.dt=new Date,e.dt},e.form.hasOwnProperty(e.dataName)&&e.form[e.dataName]?e.dt=moment(1e3*e.form[e.dataName].sec):e.today(),t.datetimepicker({locale:e.language,useCurrent:e.useCurrent,defaultDate:e.dt,format:a,extraFormats:[a],tooltips:{today:"Сегодня",clear:"Очистить",close:"Закрыть",selectMonth:"Выбрать месяц",prevMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",selectYear:"Выбрать год",prevYear:"Предыдущий год",nextYear:"Следующий год",selectDecade:"Выбрать декаду",prevDecade:"Пердыдущая декада",nextDecade:"Следующая декада",prevCentury:"Предыдущее столетье",nextCentury:"Следующее столетье",pickHour:"Выбрать час",incrementHour:"Увеличить час",decrementHour:"Уменьшить час",pickMinute:"Выбрать минуту",incrementMinute:"Увеличить минуту",decrementMinute:"Уменьшить минуту",pickSecond:"Выбрать секунду",incrementSecond:"Увеличить секунду",decrementSecond:"Уменьшить секунду",togglePeriod:"Переключить период",selectTime:"Выбрать время"}}),i(),t.find("input").on("blur",function(){i()})}}})}(),function(){"use strict";angular.module("components.atomDatetimepicker").controller("AtomDatetimepickerCtrl",["$scope","$rootScope",function(e,t){e.vm={message:"Bootstrap DateTimePicker Directive",dateTime:{}},e.$watch("change",function(){console.log(e.vm.dateTime)})}])}(),function(){"use strict";angular.module("components.atomDatepicker",[])}(),function(){"use strict";angular.module("components.atomDatepicker").directive("atomDatepicker",["SessionService",function(e){return{restrict:"A",controller:["$scope","$element","uibDatepickerPopupConfig",function(e,t,n){var i=t.find("input").attr("name");return n.clearText="Очистить",n.closeText="Закрыть",n.currentText="Сегодня",e.today=function(){return e.dt=new Date,e.dt},e.form.hasOwnProperty(i)&&e.form[i]?e.dt=new Date(1e3*e.form[i].sec):e.today(),e.open=function(t){return t.preventDefault(),t.stopPropagation(),e.opened=!0,e.opened},e.dateOptions={"year-format":"'yy'","starting-day":1},e.$watch("dt",function(){e.form[i]=e.dt.toString().replace(/( \((.+)\))/g,""),e.$emit("setDateVar",e.dt)}),e.$watch("form.date",function(){e.form[i]||e.today()}),e.format="dd.MM.yyyy",e.format}]}}])}(),function(){"use strict";angular.module("components.aclMarkup",[])}(),function(){"use strict";angular.module("components.aclMarkup").directive("aclMarkup",function(){return{restict:"AE",controller:["$scope","$q","EntityService","AuthService","_",function(e,t,n,i,a){t.all([i.properties(),n.getEntities()]).then(function(t){var n=t[0].data.entities,i=t[1].data,o=a.map(i,function(e,t){return e.name=t,e.position=angular.isDefined(n[t])?n[t].position:1001,e});o.unshift({title:"Административная панель",name:"atom",position:0}),o.unshift({title:"Сайт",name:"index",position:0}),o=a.sortBy(o,function(e){return e.position}),a.each(o,function(t){var n=t.name;"undefined"==typeof e.optionsData[e.key].sourceValues[n]&&(e.optionsData[e.key].sourceValues[n]={}),e.optionsData[e.key].sourceValues[n].title=t.title,e.optionsData[e.key].sourceValues[n].key=n,e.optionsData[e.key].options.push(e.optionsData[e.key].sourceValues[n])})})}]}})}(),angular.module("ngLocale",[],["$provide",function(e){var t={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["до полудня","после полудня"],DAY:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],MONTH:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],SHORTDAY:["вс","пн","вт","ср","чт","пт","сб"],SHORTMONTH:["янв.","февр.","марта","апр.","мая","июня","июля","авг.","сент.","окт.","нояб.","дек."],fullDate:"EEEE, d MMMM y 'г'.",longDate:"d MMMM y 'г'.",medium:"dd.MM.yyyy H:mm:ss",mediumDate:"dd.MM.yyyy",mediumTime:"H:mm:ss","short":"dd.MM.yy H:mm",shortDate:"dd.MM.yy",shortTime:"H:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"руб.",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"ru-ru",pluralCat:function(e){return e%10==1&&e%100!=11?t.ONE:e==(0|e)&&e%10>=2&&4>=e%10&&(12>e%100||e%100>14)?t.FEW:e%10==0||e==(0|e)&&e%10>=5&&9>=e%10||e==(0|e)&&e%100>=11&&14>=e%100?t.MANY:t.OTHER}})}]),function(){"use strict";angular.module("atom",["ngAnimate","ngCookies","ngTouch","ngSanitize","vAccordion","ng.deviceDetector","ui.router","ui.tinymce","ui.bootstrap","ui.tree","ngScrollable","underscore","localytics.directives","components.session","components.auth","components.siteHeader","components.navbar","components.collapseNav","components.entity","components.pagination","components.buildFormMarkup","components.atomDatepicker","components.entityMarkup","components.aclMarkup","components.popup","components.atomPassword","components.atomFile","components.atomDatetimepicker","components.helper","directives.atomFields","directives.atomDiagram","rest.infographic","bootstrapLightbox","infographic","authorization","dashboard","entityPage","errorPage"])}(),function(){"use strict";angular.module("atom").run(["$rootScope","$state","$http","SessionService","EntityService",function(e,t,n,i,a){e.$on("$stateChangeSuccess",function(n,o,s,l){if(e.activePage=o.name,e.activeEntity="pagesList"===o.name?"page":s.entity,!("logout"===l.name&&"login"===o.name||"login"===l.name&&"logout"===o.name)){"error500"==l.name&&(e.activePage=o.name,e.activeEntity=s.entity,e.hidePanels=!1);var r=["login","logout"],c=i.getSessionID();c&&(e.authorized=!0,a.getEntity("user",i.getUserID()).then(function(n){n.data.error&&403==n.data.error.code?t.go("logout"):e.userName=n.data.data[0].title},function(){t.go("logout")})),Lazy(r).contains(o.name)||c||t.go("logout"),c&&"login"===o.name&&t.go("dashboard")}})}])}(),function(){"use strict";angular.module("atom").constant("toastr",toastr).constant("moment",moment).constant("baseURL",BASE_URI).constant("debug",-1!==window.location.search.indexOf("debug")).constant("loginPeriod",18e5)}(),function(){"use strict";angular.module("atom").config(["$logProvider","$httpProvider","$stateProvider","toastr","SessionServiceProvider",function(e,t,n,i,a){t.defaults.headers.post={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},t.defaults.headers.get={Accept:"application/json"},a.$get().getSessionID()&&(t.defaults.headers.common.Token=a.$get().getSessionID()),t.interceptors.push(["$q","$injector","_","loginPeriod",function(e,t,n,a){return{request:function(e){var n=t.get("$cookies").get("rememberMe"),i=t.get("$cookies").get("token"),o=t.get("$cookies").get("homepage");if(i&&"0"===n){var s=new Date;s.setTime(s.getTime()+a);var l={expires:s,path:"/"};t.get("$cookies").put("token",i,l),t.get("$cookies").put("rememberMe",i,l),t.get("$cookies").put("homepage",o,l)}return e},responseError:function(a){return 500==a.status&&(t.get("$rootScope").errorMessage=a.data.error.message,t.get("$state").go("error500")),401==a.status&&"/user/logout/"!==a.config.url?t.get("$state").go("logout"):400==a.status?a.data.error.message&&i.error(a.data.error.message):403==a.status?"/atom/properties/"==a.config.url&&(a.data.error.message&&i.error(a.data.error.message),t.get("$state").go("logout")):n.each(a.data.error["null"],function(e){e.message&&i.error(e.message)}),e.reject(a)}}}]),e.debugEnabled(!0),i.options.timeOut=3e3,i.options.positionClass="toast-top-right",i.options.preventDuplicates=!1,i.options.closeButton=!0}])}(),angular.module("atom").run(["$templateCache",function(e){e.put("app/components/atomDatetimepicker/atomDatetimepicker.html","<input type=text class=form-control id={{dataName}} name={{dataName}}> <span class=input-group-addon><i class=fa ng-class=\"{\r\n    'fa-calendar': (dataType === 'date' || dataType === 'datetime'),\r\n    'fa-clock-o':  dataType === 'time'\r\n    }\"></i> </span>"),e.put("app/components/popup/popup.html",'<div class=modal-header><h3>Удаление</h3></div><div class=modal-body><span ng-if=title><strong>{{title}}</strong><br></span>{{ message }}</div><div class=modal-footer><button class="btn btn-primary" ng-click=ok()>Удалить</button> <button class="btn btn-warning" ng-click=cancel()>Отмена</button></div>'),e.put("app/components/siteHeader/siteHeader.html",'<header class="top-header clearfix"><!-- Logo --><div class=logo><a href=#/ ><!-- <span class="logo-icon glyphicon glyphicon-fire"></span> --> <span>ATOM</span></a></div><!-- needs to be put after logo to make it working--><div class=menu-button ng-click="$root.toggleCanvas = !$root.toggleCanvas"><span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></div><div class=top-nav><ul class="nav-right pull-right list-unstyled"><li class="dropdown text-normal nav-profile" uib-dropdown><a href=javascript:; class=dropdown-toggle uib-dropdown-toggle><span>{{$root.userName}}</span></a><ul class="dropdown-menu with-arrow pull-right"><li><a ui-sref=logout><i class="fa fa-sign-out"></i> <span data-i18n="Log Out">Выход</span></a></li></ul></li></ul></div></header>'),e.put("app/components/navbar/navbar.html",'<div class=nav-wrapper><ul id=nav class=nav data-slim-scroll data-collapse-nav data-highlight-active><li class=infoblockMenu class="open active"><a href=#/pages><i class="fa fa-file-text-o"></i><span data-i18n=Pages>Инфоблоки</span></a><ul><li ng-repeat="(pageName, page) in pages" ng-if=page.icon ng-class="{\'active\': $root.activeEntity == page.entityName}"><a ui-sref="entitiesList({\'entity\': page.entityName})"><i class="fa {{page.icon}}"></i> <span data-i18n=PageNamePlaceHere>{{ page.title }}</span></a></li></ul></li></ul></div>'),e.put("app/modules/authorization/authorization.html",'<div class=page-signin><div class=signin-header><section class="logo text-center"><a href=#/ >ATOM</a></section></div><div class=main-body><div class=container><div class=form-container><form class=form-horizontal ng-submit=makeLogin() autocomplete=off><fieldset><input style=display:none> <input type=password style=display:none><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-envelope"></span></div><input type=email class="form-control input-lg input-round text-center" placeholder=Email ng-model=user.email></div><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-lock"></span></div><input type=password class="form-control input-lg input-round text-center" placeholder=Пароль ng-model=user.password></div><div class=form-group><label class="ui-checkbox rememberMeLabel"><input name=checkbox1 type=checkbox value=option2 ng-model=rememberMe> <span>Запомнить меня</span></label></div><div class=form-group><input type=submit class="btn btn-primary btn-lg btn-round btn-block text-center" value=Войти></div></fieldset></form></div></div></div></div>'),
e.put("app/components/pagination/pagination.html",'<footer class=table-footer><div class=row><div class="col-md-6 page-num-info"><span>Элементов на странице:&nbsp;<select data-ng-model=perPage data-ng-options="num.title for num in numPerPageOpt track by num.value" data-ng-change=onNumPerPageChange()></select></span></div><div class="col-md-6 text-right pagination-container scrollme" id=pagination ng-scrollable=scrollConfig><ul class="pagination-sm pagination"><!--<li ng-class="{disabled: noPrevious()}"><a ng-click="prevPage(true);" href="">Первая</a>--><!--</li>--><!--<li ng-class="{disabled: noPrevious()}"><a ng-click="prevPage();" href="">‹</a>--><!--</li>--><li ng-repeat="(pageId,page) in pagesCountList" ng-class="{active: isActive(pageId)}" ng-show=isInRange(pageId)><a ng-bind=page ng-click="goToPage(page - 1);" href=""></a></li><!--<li ng-class="{disabled: noNext()}"><a ng-click="nextPage();" href="">›</a></li>--><!--<li ng-class="{disabled: noNext()}"><a ng-click="nextPage(true);" href="">Последняя</a>--><!--</li>--></ul></div></div></footer>'),e.put("app/modules/infographic/infographic.html",'<div class=page><div ng-hide=scheme class="form-group refresh-position"><div class="col-md-12 text-center"><span style="font-size: 24px" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></div></div><section class="panel panel-default"><div class=panel-heading><strong><span class="glyphicon glyphicon-th"></span>Формирование отчёта</strong></div><div class=panel-body><form class=form-horizontal autocomplete=off atom-form><input type=text style="position: absolute;left: -1000px"> <input type=password style="position: absolute;left: -1000px"><div class=row ng-if=showGraph><div class=col-md-12><div class="panel panel-default"><div class=panel-body><div atom-flot-chart flot-data=line1.data flot-options=line1.options style="width: 100%; height: 300px"></div><div id=legend></div></div></div></div></div><div class=form-group ng-repeat="(itemName, item) in scheme"><label class=col-sm-2 for="{{ itemName }}">{{ item.title }} <span class=require>*</span></label><div class=col-sm-10 ng-if="item.type === \'string\'" atom-field-string field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if="item.type === \'password\'" atom-field-password field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if="item.type === \'boolean\'" atom-field-boolean field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if="item.type === \'entity\'" atom-field-entity field=entity[itemName] field-name=itemName linked-entity=linkedEntities[item.entity.model] entity-model=entityModels scheme=item></div><div class=col-sm-10 ng-if="item.type === \'select\'" atom-field-select field=entity[itemName] field-name=itemName entity-model=entityModels scheme=item></div><div class=col-sm-10 ng-if="item.type === \'date\' || item.type === \'time\' || item.type === \'datetime\'" atom-field-datetime field=entity[itemName] field-name=itemName scheme=item></div><div style="clear: both; margin-bottom: 10px"></div></div><div class=form-group><div class=col-sm-2></div><div class=col-sm-10><div class=pull-right><div class="btn-group dropup pull-right margin-right-10" uib-dropdown><button type=button ng-click=goToList() class="btn btn-warning">Отменить</button></div></div><div class="btn-group dropup pull-right margin-right-10" uib-dropdown><button ng-click=getGiagram() type=button class="btn btn-primary">Сформировать</button></div></div></div></form></div></section></div>'),e.put("app/directives/atomFields/atomFieldBoolean/atomFieldBoolean.html",'<div class=input-group><div class=col-sm-10><label class=switch><input type=checkbox id="{{ itemName }}" ng-model=field><i></i></label></div></div>'),e.put("app/directives/atomFields/atomFieldDatetime/atomFieldDatetime.html","<div class=input-group><input type=text class=form-control id={{fieldName}} name={{fieldName}}> <span class=input-group-addon><i class=fa ng-class=\"{\r\n        'fa-calendar': (scheme.type === 'date' || scheme.type === 'datetime'),\r\n        'fa-clock-o':  scheme.type === 'time'\r\n        }\"></i></span></div>"),e.put("app/directives/atomFields/atomFieldEntity/atomFieldEntity.html",'<select ng-if=scheme.multiple chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" multiple ng-options="b as b.title for b in list track by b.id" ng-model=entityModel[fieldName] ng-change=triggerEvent()><option value=""></option></select><select ng-if=!scheme.multiple chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" ng-options="b as b.title for b in list track by b.id" ng-model=entityModel[fieldName] ng-change=triggerEvent()><option value=""></option></select>'),e.put("app/directives/atomFields/atomFieldPassword/atomFieldPassword.html",'<input autocomplete=off id="{{ itemName }}" placeholder="" type=password class=form-control ng-model=field>'),e.put("app/directives/atomFields/atomFieldSelect/atomFieldSelect.html",'<select ng-if=scheme.multiple chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" multiple ng-options="b as b.title for b in list track by b.id" ng-model=entityModel[fieldName]><option value=""></option></select><select ng-if=!scheme.multiple chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" ng-options="b as b.title for b in list track by b.id" ng-model=entityModel[fieldName]><option value=""></option></select>'),e.put("app/directives/atomFields/atomFieldString/atomFieldString.html",'<input autocomplete=off id="{{ itemName }}" placeholder="" type=text class=form-control ng-model=field>'),e.put("app/modules/dashboard/dashboard.html",""),e.put("app/modules/errorPage/500.html",'<div class=page-err><div class="err-container text-center"><div class=err><div class=err-inner><h1>500</h1><h2>Server Error</h2></div></div><div class=err-mss><p>{{$root.errorMessage}}</p></div><div class=err-body><a ui-sref=dashboard class="btn btn-lg btn-primary" ng-click=closeError()><span class="glyphicon glyphicon-home"></span> <span class=space></span> Вернуться на главную</a></div></div><!--     <div class="footer text-center">\r\n          Copyright 2014 {{main.brand}} Admin\r\n      </div> --></div>'),e.put("app/modules/entityPage/entitiesList/entitiesList.html",'<div class=page style="position: relative"><section ng-show="renderData && last.row && last.col" class="panel panel-default table-dynamic"><div style="position: relative" class="panel-heading text-right"><div id=table-title style="position: absolute; left: 10px; top: 20px; font-weight: 600" data-ng-bind=tableTitle></div><button tooltip="График статистики" tooltip-placement=top tooltip-append-to-body=true ng-show=graphicsEnabled class="btn btn-success btn-w-md listControlButtons" type=button ng-click=goToGraphic()>Статистика</button> <button tooltip="Добавить новый элемент" tooltip-placement=top tooltip-append-to-body=true ng-show=createEnabled class="btn btn-success btn-w-md listControlButtons" type=button ng-click=new()>Добавить</button><!--go(,true);--> <button tooltip="Экспорт элементов в XLS" tooltip-placement=top tooltip-append-to-body=true ng-show=exportEnabled class="btn btn-primary btn-w-md listControlButtons" ng-click=exportStack(); type=button>Выгрузить</button> <button tooltip="Удалить выбранные элементы" tooltip-placement=top tooltip-append-to-body=true ng-show=deleteEnabled ng-disabled=isSelectItems(); class="btn btn-danger btn-w-md listControlButtons" ng-click=deleteStack(); type=button>Удалить</button><form method=post id=downloadForm></form></div><div data-ng-show="list.scheme && hasSearchFields" class=table-filters><div class=row><div class="col-sm-4 col-xs-6"><form class="ng-scope ng-pristine ng-valid"><div class=input-group><input type=text placeholder=Поиск... class="form-control ng-pristine ng-valid" ng-model=searchKeywords ng-keyup=keyUpHandler($event) ng-class="{\'input-danger\': searchKeywordsError}"> <span class=input-group-addon ng-click=search()><i class="fa fa-search"></i></span></div><input type=hidden value="" id=hidden-q></form></div><!--<div class="col-sm-3 col-xs-6 filter-result-info">\r\n            <span>\r\n                Showing {{filteredStores.length}}/{{stores.length}} entries\r\n            </span>\r\n        </div>--></div></div><div class=panel-body><section class=table-flip-scroll><table id=table-{{model}} class="table table-bordered table-striped cf"><thead class=cf><tr><th style="padding-left: 10px; height: 41px" class=checkAll-th><div class=th style="padding-left: 0px;padding-right: 0px"><label style="margin-right: 0" class=ui-checkbox><input class=remAll type=checkbox value="" data-ng-click=selectAllItems($event);> <span></span></label></div></th><th style="height: 41px" ng-repeat="(fieldKey, field) in fieldsInTable track by $index" ng-if="field.sort && fieldKey !== \'enabled\' "><div class=th>{{field.title}} <span class=arrows-sort><span ng-show=field.sort class="fa fa-angle-up" ng-click=" order(fieldKey,-1) " ng-class="{active: curSortField == fieldKey && curSortOrder == -1 }"></span> <span ng-show=field.sort class="fa fa-angle-down" ng-click=" order(fieldKey,1) " ng-class="{active: curSortField == fieldKey && curSortOrder == 1 }"></span></span></div></th><th style="height: 41px" ng-if=list.scheme.enabled><div class=th>Доступность <span class=arrows-sort><span class="fa fa-angle-up" ng-click=" order(\'enabled\',-1) " ng-class="{active: curSortField == \'enabled\' && curSortOrder == -1 }"></span> <span class="fa fa-angle-down" ng-click=" order(\'enabled\',1) " ng-class="{active: curSortField == \'enabled\' && curSortOrder == 1 }"></span></span></div></th><th style="height: 41px" class=action-th><div class=th>Действия</div></th></tr></thead><tbody><tr ng-repeat="item in renderData track by $index" ng-init="last.row = $last"><td style="height: 41px" class=testx style="width: 15px; padding-left: 10px; padding-right: 0px"><label style="margin-right: 0" class=ui-checkbox><input class=remBox type=checkbox value="{{ item._id.$id }}" ng-click=updateRemItems($event);> <span></span></label></td><td class=fieldCell style="height: 41px" list-wrapp={{item[fieldKey]}} ng-repeat="(fieldKey, field) in fieldsInTable track by $index" ng-init="last.col = $last" entity-list-markup entity=item[fieldKey] entity-name=fieldKey field=field>{{::item[fieldKey]}}</td><td style="height: 41px" class=visible-td ng-if=list.scheme.enabled><!--<label class="switch"  data-atom-toggle-visible="" data-model="{{model}}" data-id="{{itemId|ObjectKey:list.data}}" >--><label class=switch data-atom-toggle-visible="" data-model={{model}} data-id={{itemId}}><input type=checkbox data-ng-model=item.enabled ng-change=setEdited(item)> <i class=slim></i></label></td><td style="height: 41px; min-width: 85px" class=action-td><a tooltip="Просмотр и редактирование элемента" tooltip-placement=left tooltip-append-to-body=true class="btn-icon btn-icon-min-sm btn-edit" ui-sref="entityEdit({ entity: model, id: item._id.$id })"><i ng-if=editEnabled class="glyphicon glyphicon-pencil"></i> <i ng-if=!editEnabled class="fa fa-th-list"></i> </a><!--<a class="btn-icon btn-icon-min-sm btn-remove cursor-pointer" data-rem-id="{{itemId|ObjectKey:list.data}}" data-ng-click="delete($event);">--> <a tooltip="Удалить элемент" tooltip-placement=left tooltip-append-to-body=left ng-show=deleteEnabled class="btn-icon btn-icon-min-sm btn-remove cursor-pointer" data-rem-id={{itemId}} data-ng-click="deleteStack(item._id[\'$id\']);"><i class="glyphicon glyphicon-trash"></i></a></td></tr></tbody></table></section></div><atom-pagination></atom-pagination></section><div ng-hide="renderData && last.row && last.col" class="form-group refresh-position"><div class="col-md-12 text-center"><span style="font-size: 24px" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></div></div></div>'),e.put("app/modules/entityPage/entityEdit/entityEdit.html",'<div class=page style="position: relative"><section ng-show=formSchema class="panel panel-default"><div class=panel-heading><strong data-ng-show=isNew><span class="glyphicon glyphicon-th"></span> Создание элемента</strong> <strong data-ng-hide=isNew><span class="glyphicon glyphicon-th"></span> Редактирование элемента <span ng-if=itemTitle>"<span class=edit-item-title>{{itemTitle}}</span>"</span></strong></div><div class=panel-body><div class=row><div class=ui-tab-container ng-if="tabsCount > 1"><tabset class=ui-tab><tab heading={{tabTitle}} ng-repeat="(tabKey, tabTitle) in tabs"><form class=form-horizontal autocomplete=off><input type=text style=display:none id=email name=email> <input type=password style=display:none id=password name=password><div class=form-group ng-if="field.tab === tabKey" ng-show="field.visible !== false" ng-repeat="(key,field) in formSchema" build-form-markup="" markup-data={{field}} field-readonly={{!updateEnabled}}></div><div class="form-group edit-buttons"><div class=col-sm-2></div><div class=col-sm-10><div class=pull-right><!--<a  class="btn btn-w-md btn-gap-v btn-warning">Отмена</a>--><div class="btn-group dropup pull-right margin-right-10" uib-dropdown><button type=button ng-click=goToList() class="btn btn-warning">Отменить</button> <button type=button class="btn btn-warning dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul class="dropdown-menu pull-right"><li><a href=javascript:; ng-click=rollback();>Отменить изменения</a></li><li><a ui-sref="entitiesList({\'entity\': entity })">Вернуться к списку</a></li></ul></div></div><div ng-if=deleteEnabled class="btn-group dropup pull-right margin-right-10" ng-show=!isNew uib-dropdown><button type=button ng-click=remove() class="btn btn-danger">Удалить</button> <button type=button class="btn btn-danger dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul class="dropdown-menu pull-right"><!--<li><a href="javascript:;">Предварительный просмотр</a></li>--><li><a href=javascript:; ng-click=clear();>Очистить форму</a></li><li><a href=javascript:; ng-click=remove();>Удалить запись</a></li></ul></div><button ng-show=!deleteEnabled class="btn btn-danger pull-right margin-right-10 btn-w-md listControlButtons" ng-click=clear(); type=button>Очистить форму</button><div ng-if=updateEnabled class="btn-group dropup pull-right margin-right-10" uib-dropdown><button ng-click=save(true) type=button class="btn btn-primary">Сохранить</button> <button type=button class="btn btn-primary dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul class="dropdown-menu pull-right"><!--<li><a href="javascript:;">Предварительный просмотр</a></li>--><li><a href=javascript:; ng-click=save(true);close()>Сохранить и вернуться к списку</a></li><li><a href=javascript:; ng-click=save(false);>Сохранить и остаться</a></li></ul></div></div></div></form></tab></tabset></div></div><form ng-if="tabsCount === 1" class=form-horizontal autocomplete=off><input type=text style="position: absolute;left: -1000px"> <input type=password style="position: absolute;left: -1000px"><div class=form-group ng-show="field.visible !== false" ng-repeat="(key,field) in formSchema" build-form-markup="" markup-data={{field}} field-readonly={{!updateEnabled}}></div><div class=form-group><div class=col-sm-2></div><div class=col-sm-10><div class=pull-right><!--<a  class="btn btn-w-md btn-gap-v btn-warning">Отмена</a>--><div class="btn-group dropup pull-right margin-right-10" uib-dropdown><button type=button ng-click=goToList() class="btn btn-warning">Отменить</button> <button ng-show=updateEnabled type=button class="btn btn-warning dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul ng-show=updateEnabled class="dropdown-menu pull-right"><li><a href=javascript:; ng-click=rollback();>Отменить изменения</a></li><li><a ui-sref="entitiesList({\'entity\': entity })">Вернуться к списку</a></li></ul></div></div><div ng-show=deleteEnabled class="btn-group dropup pull-right margin-right-10" ng-show=!isNew uib-dropdown><button type=button ng-click=remove() class="btn btn-danger">Удалить</button> <button type=button class="btn btn-danger dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul class="dropdown-menu pull-right"><!--<li><a href="javascript:;">Предварительный просмотр</a></li>--><li><a href=javascript:; ng-click=clear();>Очистить форму</a></li><li><a href=javascript:; ng-click=remove();>Удалить элемент</a></li></ul></div><div ng-if=updateEnabled class="btn-group dropup pull-right margin-right-10" uib-dropdown><button ng-click=save(true) type=button class="btn btn-primary">Сохранить</button> <button type=button class="btn btn-primary dropdown-toggle" uib-dropdown-toggle><span class=caret></span> <span class=sr-only>Toggle Dropdown</span></button><ul class="dropdown-menu pull-right"><!--<li><a href="javascript:;">Предварительный просмотр</a></li>--><li><a href=javascript:; ng-click=save(true);close()>Сохранить и вернуться к списку</a></li><li><a href=javascript:; ng-click=save(false);>Сохранить и остаться</a></li></ul></div></div></div></form></div></section><div ng-hide=formSchema class="form-group refresh-position"><div class="col-md-12 text-center"><span style="font-size: 24px" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></div></div></div>'),e.put("app/modules/entityPage/pagesList/items_renderer.html",'<div ng-init="hovered = false" ng-mouseover=hoverIn(this); ng-mouseleave=hoverOut(this) ng-class="{\'angular-ui-tree-handle\': item.isRoot === false}" ng-attr-data-nodrag="{{item.isRoot === true}}" class=angular-ui-tree-handle-nodrag><span data-ng-show="item.items.length > 0"><a class=angular-ui-tree-icon data-nodrag ng-click=toggle(this)><span class=angular-ui-tree-icon-collapse ng-class="{\'collapsed\': collapsed, \'uncollapsed\': !collapsed}"></span> </a></span>{{item.title}} <a ng-show=hovered ng-if=!item.isRoot class="pull-right btn-icon btn-icon-min-sm btn-danger" data-nodrag ng-click="removeItem(item, remove)" href=javascript:void(0)><i class="glyphicon glyphicon-trash"></i> </a><a ng-show=hovered ng-if=!item.isRoot class="pull-right btn-icon btn-icon-min-sm btn-edit" data-nodrag ui-sref="entityEdit({ entity: \'page\', id: item._id.$id })"><i class="glyphicon glyphicon-pencil"></i> </a><a ng-show=hovered class="pull-right btn-icon btn-icon-min-sm btn-success" data-nodrag ui-sref="entityAddPage({ entity: \'page\', pid: item._id.$id })"><i class="glyphicon glyphicon-plus"></i></a></div><ol ui-tree-nodes=options ng-model=item.items ng-class="{hidden: collapsed}"><li ng-repeat="item in item.items" ui-tree-node ng-include="\'app/modules/entityPage/pagesList/items_renderer.html\'"></li></ol>'),e.put("app/modules/entityPage/pagesList/pagesList.html",'<div class="page page-table" style="position: relative"><section ng-show=list.scheme class="panel panel-default"><div class=panel-heading><strong><span class="glyphicon glyphicon-th"></span> Текстовые страницы</strong></div><div class=panel-body><div ui-tree=options><ol ui-tree-nodes ng-model=data data-nodrop-enabled><li ng-repeat="item in data" ui-tree-node ng-include="\'app/modules/entityPage/pagesList/items_renderer.html\'"></li></ol></div></div></section><div ng-hide=list.scheme class="form-group refresh-position"><div class="col-md-12 text-center"><span style="font-size: 24px" class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span></div></div></div>')}]);