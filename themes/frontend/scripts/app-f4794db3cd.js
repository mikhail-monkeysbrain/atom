!function(){"use strict";angular.module("page",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("customHandler",{views:{"content@":{templateUrl:"app/modules/page/page.html",controller:"CustomPageCtrl"}}}),e.state("page",{url:"/page",views:{"content@":{templateUrl:"app/modules/page/page.html",controller:"TestPageCtrl"}}}),t.otherwise(function(e){e.get("$state").go("customHandler")})}])}(),function(){"use strict";angular.module("page").controller("CustomPageCtrl",["$scope","$state","$location","EntityAPIService","$cookies",function(e,t,i,n,o){function r(){null!==t.get("error404")?t.go("error404"):t.go("app")}var s=i.url(),a=o.get("curLocale")||"ru";n.getTextPage(s).then(function(t){t.data.total>0?"en"===a?e.pageContent=t.data.data[0].en_content:e.pageContent=t.data.data[0].content:r()})}])}(),function(){"use strict";angular.module("demo",[]).config(["$stateProvider",function(e){e.state("app.demo",{url:"demo","abstract":!0}),e.state("app.demo.index",{url:"",views:{"content@":{templateUrl:"app/modules/demo/demo.html",controller:"DemoCtrl"}}}).state("app.demo.read",{url:"/:id",views:{"content@":{templateUrl:"app/modules/demo/read/demoRead.html",controller:"DemoReadCtrl"}}})}])}(),function(){"use strict";angular.module("demo").controller("DemoReadCtrl",["$scope",function(e){e.foo="test"}])}(),function(){"use strict";angular.module("authorization",[]).config(["$stateProvider",function(e){e.state("login",{url:"/login",views:{"content@":{templateUrl:"app/modules/authorization/signin/authorization.html",controller:"AuthorizationCtrl"}}}).state("logout",{url:"/logout",views:{"content@":{templateUrl:"app/modules/authorization/signin/authorization.html",controller:"AuthorizationCtrl"}}}).state("register",{url:"/signup",views:{"content@":{templateUrl:"app/modules/authorization/signup/registration.html",controller:"RegistrationCtrl"}}})}])}(),function(){"use strict";angular.module("authorization").controller("RegistrationCtrl",["$scope","$state","AuthService",function(e,t,i){e.makeRegistration=function(){i.register(e.user).then(function(e){e.data.success?(toastr.success(e.data.success.message),t.go("login")):toastr.error(e.data.error.message)})}}])}(),function(){"use strict";angular.module("authorization").controller("AuthorizationCtrl",["$scope","$rootScope","$state","$document","$http","$cookies","AuthService","toastr","SessionService","RestrictionsService","$stateParams","loginPeriod","baseURL",function(e,t,i,n,o,r,s,a,l,c,u,d,p){var m=31536e6;e.rememberMe=!0,e.user={email:"kamal@hismith.ru",password:"multipass"},i.is("logout")&&(t.hidePanels=!0,t.authorized=!1,void 0!==l.getSessionID()&&(l.setSessionID(void 0),s.logout().then(function(){r.remove("token"),r.remove("rememberMe"),c.resetPermissions().then(function(){i.go("app")})})),i.go("login")),e.makeLogin=function(){s.login(e.user).then(function(n){if(n.data.success){var o=new Date,s={path:"/"};e.rememberMe?o.setTime(o.getTime()+m):o.setTime(o.getTime()+d),s.expires=o,l.setSessionID(n.data.success.user.token),l.setUserID(n.data.success.user._id.$id),a.success(n.data.success.message),t.authorized=!0,t.userName=n.data.success.user.name,r.put("token",n.data.success.user.token,s),r.put("rememberMe",e.rememberMe?1:0,s),c.resetPermissions().then(function(){i.go("app")})}else a.error(n.data.error.message)})}}])}(),function(){"use strict";angular.module("rest.auth",[]).config(["$provide",function(e){e.decorator("AuthService",["$delegate","$location","AuthServiceMock","debug",function(e,t,i,n){return n&&(e=i),e}])}])}(),function(){"use strict";angular.module("rest.auth").service("RestrictionsAPIService",["$http","$httpParamSerializer","baseURL",function(e,t,i){this.getRestrictions=function(){return e.get(i+"/atom/entities/")}}])}(),function(){"use strict";angular.module("rest.restrictionsAPI",[]).config(["$provide",function(e){e.decorator("RestrictionsAPIService",["$delegate","$location","RestrictionsAPIServiceMock","debug",function(e,t,i,n){return n&&(e=i),e}])}])}(),function(){"use strict";angular.module("rest.restrictionsAPI").service("RestrictionsAPIServiceMock",["$http",function(e){this.getRestrictions=function(){return e.get("/app/rest/restrictions/fixture/restrictions.json")}}])}(),function(){"use strict";angular.module("rest.entity",[]).config(["$provide",function(e){e.decorator("EntityAPIService",["$delegate","EntityAPIServiceMock","debug",function(e,t,i){return i&&(e=t),e}])}])}(),function(){"use strict";angular.module("rest.entity").service("EntityAPIServiceMock",["$http","$httpParamSerializer",function(e,t){this.getEntities=function(){return e.get("/app/rest/entity/fixture/entities.json")},this.getEntitiesList=function(t){return e.get("/app/rest/entity/fixture/usersList.json")},this.getEntityDescription=function(t){return e.get("/app/rest/entity/fixture/usersDescription.json")},this.getEntityPage=function(t,i,n){return 0===i?e.get("/app/rest/entity/fixture/usersPage1.json"):e.get("/app/rest/entity/fixture/usersPage2.json")},this.getEntity=function(t,i){return e.get("/app/rest/entity/fixture/userExample.json")},this.saveEntity=function(i,n){return e.get("/app/rest/entity/fixture/userSaved.json",t(n))},this.removeEntity=function(i,n){return e.get("/app/rest/entity/fixture/userSaved.json",t(n))},this.getTextPage=function(t){return"/page1"==t?e.get("app/rest/entity/fixture/page.json"):e.get("app/rest/entity/fixture/pageNotFound.json")}}])}(),function(){"use strict";angular.module("rest.entity").service("EntityAPIService",["$http","$httpParamSerializer","baseURL",function(e,t,i){var n=this;this.getEntities=function(t){var n=t?"?condition[name]="+t:"";return e.get(i+"/atom/entities/"+n)},this.getEntitiesList=function(t,n,o){n=n||0;var r="";if(angular.isObject(o))for(var s in o)r+="&sort["+s+"]="+o[s];return e.get(i+"/"+t+"/?condition[enabled][$ne]=null&limit="+n+r)},this.getEntityDescription=function(e){return n.getEntities(e)},this.getEntityPage=function(t,n,o,r,s,a){var l=r&&s?"&sort["+r+"]="+s:"",c=a?"&condition[$search]="+a:"";return e.get(i+"/"+t+"/page/"+n+"/?condition[enabled][$ne]=null&limit="+o+l+c)},this.getEntity=function(t,n){return e.get(i+"/"+t+"/"+n+"/")},this.saveEntity=function(n,o,r,s){var a="undefined"==typeof o._id&&r?"create":"update";return s?e.post(i+"/"+n+"/"+a+"/",o,{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":void 0,Accept:"application/json"}}):e.post(i+"/"+n+"/"+a+"/",t(o))},this.removeEntity=function(n,o){return e.post(i+"/"+n+"/delete/",t(o))},this.exportEntity=function(e,t,i,n){var o=[];if(t.length)for(var r=0;r<t.length;r++)o.push(angular.element('<input type="hidden" name="condition[_id][$in][]" value="'+t[r]+'">'));var s=angular.element("#downloadForm");s.html("");var a=angular.element('<input type="hidden" name="limit" value="0">'),l=i&&n?angular.element('<input type="hidden" name="sort['+i+']" value="'+n+'">'):"";Lazy(o).each(function(e){s.append(e)}),s.append(a),s.append(l),s.attr({action:"/"+e+"/export/"})[0].submit()},this.getLinkedEntities=function(t,n){var o=[],r=[];if(n.length){var s,a;for(s=0,a=0;s<n.length;s++,a++)n[s]&&o.push("condition[_id][$in][]="+n[s].$id),19!=a&&s!=n.length-1||(o=o.join("&"),r.push(e.get(i+"/"+t+"/?"+o+"&limit=0")),a=-1,o=[])}return r},this.getTextPage=function(t){return e.get(i+"/page/?limit=0&condition[url]="+t)}}])}(),function(){"use strict";angular.module("rest.auth").service("AuthServiceMock",["$http",function(e){this.logout=function(){return e.get("/app/rest/auth/fixture/logout_success.json")},this.login=function(t){var i=0===t.email.indexOf("test")?"auth.json":"auth_fail.json";return e.get("/app/rest/auth/fixture/"+i)},this.register=function(t){var i=0===t.email.indexOf("test")?"register.json":"register_fail.json";return e.get("/app/rest/auth/fixture/"+i)}}])}(),function(){"use strict";angular.module("rest.auth").service("AuthService",["$http","$httpParamSerializer","baseURL",function(e,t,i){this.logout=function(){return e.get(i+"/user/logout/")},this.login=function(n){return e.post(i+"/user/auth/pass/",t(n))},this.register=function(n){return e.post(i+"/user/auth/register/",t(n))},this.properties=function(){return e.get(i+"/atom/properties/")}}])}(),function(){"use strict";angular.module("page").controller("TestPageCtrl",["$scope",function(e){e.pageContent="test page"}])}(),function(){"use strict";angular.module("errorPage",[]).config(["$stateProvider",function(e){e.state("error500",{views:{"content@":{templateUrl:"app/modules/errorPage/500.html",controller:"ErrorPageCtrl"}}}),e.state("error404",{views:{"content@":{templateUrl:"app/modules/errorPage/404.html",controller:"ErrorPageCtrl"}}})}])}(),function(){"use strict";angular.module("errorPage").controller("ErrorPageCtrl",["$scope","$rootScope",function(e,t){}])}(),function(){"use strict";angular.module("demo").controller("DemoCtrl",["$scope",function(e){e.foo="test"}])}(),function(){"use strict";angular.module("components.session",[]).value("Session",{})}(),function(){"use strict";angular.module("components.session").service("SessionService",["$cookies","Session",function(e,t){this.getUserID=function(){return e.get("userId")},this.setUserID=function(t){var i=new Date;return i.setTime(i.getTime()+108e5),e.put("userId",t,{expires:i})},this.setSessionID=function(t){var i=new Date;return i.setTime(i.getTime()+108e5),e.put("sessionId",t,{expires:i})},this.getSessionID=function(){return e.get("sessionId")}}])}(),function(){"use strict";angular.module("components.restrictions",[])}(),function(){"use strict";angular.module("components.restrictions").service("RestrictionsService",["$q","RestrictionsAPIService",function(e,t){function i(){return angular.isDefined(n.permissionsMap)?e.when(n.permissionsMap):t.getRestrictions().then(function(e){return n.permissionsMap=e.data,n.permissionsMap})}var n=this;this.hasPermissions=function(e){return i().then(function(t){var i=e.split(".");if(1===i.length)return!0;var n=i[1],o=i[2];return n&&t[n]?angular.isDefined(t[n].routes[n+"."+o]):!1})},this.resetPermissions=function(){return t.getRestrictions().then(function(e){return n.permissionsMap=e.data,n.permissionsMap})}}])}(),function(){"use strict";angular.module("components.entity",[]).config(["$provide",function(e){e.decorator("EntityService",["$delegate","EntityServiceMock","debug",function(e,t,i){return i&&(e=t),e}])}])}(),function(){"use strict";angular.module("components.entity").service("EntityServiceMock",["$http","$httpParamSerializer",function(e,t){}])}(),function(){"use strict";angular.module("components.entity").service("EntityService",["$q","EntityAPIService",function(e,t){var i=this;i.getLinkedEntities=function(i){var n=Lazy(i).map(function(e){return"entity"===e.type?t.getEntitiesList(e.entity.model,0,0).then(function(t){return{entity:e.entity.model,data:t.data}}):void 0}).compact().toArray();return e.all(n)}}])}(),function(){"use strict";angular.module("components.localize",["ngCookies"])}(),function(){"use strict";angular.module("components.localize").directive("localize",["$cookies","$window",function(e,t){return{restrict:"E",templateUrl:"app/components/localize/localize.html",link:function(i,n,o){function r(){"en"==i.lang?i.currentLocale="English":i.currentLocale="Русский"}i.lang=e.get("curLocale")||"ru",r(),i.changeLocale=function(n){i.lang!==n&&(i.lang=n,e.put("curLocale",n),r(),t.location.reload())}}}}])}(),function(){"use strict";angular.module("directives.atomListField",[])}(),function(){"use strict";angular.module("directives.atomListField").directive("atomListField",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"=",linkedEntity:"="},templateUrl:"app/directives/atomListField/atomListField.html",link:function(e,t,i){if("entity"===e.scheme.type){var n=(Lazy(e.linkedEntity.data.data).find(function(t){return Lazy(e.field).findWhere({$id:t._id.$id})}),Lazy(e.field).map(function(t){return Lazy(e.linkedEntity.data.data).find(function(e){return e._id.$id===t.$id}).title}).compact().toArray());e.fieldLabel=n.join(", ")}else e.fieldLabel=e.field}}})}(),function(){"use strict";angular.module("directives.atomFieldString",[])}(),function(){"use strict";angular.module("directives.atomFieldString").directive("atomFieldString",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFieldString/atomFieldString.html"}})}(),function(){"use strict";angular.module("directives.atomFieldPassword",[])}(),function(){"use strict";angular.module("directives.atomFieldPassword").directive("atomFieldPassword",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFieldPassword/atomFieldPassword.html"}})}(),function(){"use strict";angular.module("directives.atomFieldEntity",[])}(),function(){"use strict";angular.module("directives.atomFieldEntity").directive("atomFieldEntity",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"=",linkedEntity:"=",entityModel:"="},templateUrl:"app/directives/atomFieldEntity/atomFieldEntity.html",link:function(e){e.entityModel[e.fieldName]=e.entityModel[e.fieldName]||[];var t=Lazy(e.linkedEntity.data.data).map(function(e){return{title:e.title,id:e._id.$id}}).toArray();e.entityModel[e.fieldName]=Lazy(e.field).map(function(e){return Lazy(t).find(function(t){return t.id===e.$id})}).compact().toArray(),e.list=t}}})}(),function(){"use strict";angular.module("directives.atomFieldBoolean",[])}(),function(){"use strict";angular.module("directives.atomFieldBoolean").directive("atomFieldBoolean",function(){return{restrict:"A",scope:{scheme:"=",fieldName:"=",field:"="},templateUrl:"app/directives/atomFieldBoolean/atomFieldBoolean.html"}})}(),function(){"use strict";angular.module("app",["ui.router","ui.bootstrap","ngAnimate","ngTouch","ngCookies","ngSanitize","pascalprecht.translate","localytics.directives","components.session","components.restrictions","components.localize","components.entity","directives.atomListField","directives.atomFieldString","directives.atomFieldPassword","directives.atomFieldBoolean","directives.atomFieldEntity","rest.auth","rest.restrictionsAPI","rest.entity","user","demo","authorization","page","errorPage"])}(),function(){"use strict";angular.module("app").run(["$rootScope","$state","$http","SessionService","RestrictionsService",function(e,t,i,n,o){var r=n.getSessionID();r&&(e.authorized=!0),e.$on("$stateChangeSuccess",function(i,r,s,a){e.activePage=r.name,e.activeEntity="pagesList"===r.name?"page":s.entity,"error500"==a.name&&(e.activePage=r.name,e.activeEntity=s.entity,e.hidePanels=!1),o.hasPermissions(r.name).then(function(e){e||t.go("app")});var l=["login","logout"],c=n.getSessionID();!Lazy(l).contains(r.name)&&!c,c&&"login"===r.name&&t.go("app")})}])}(),function(){"use strict";angular.module("app").constant("toastr",toastr).constant("baseURL","").constant("debug",!1).constant("loginPeriod",18e5)}(),function(){"use strict";angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/"}),t.otherwise(function(e){e.get("$state").go("customHandler")})}]).config(["$translateProvider","baseURL","debug",function(e,t,i){var n;angular.injector(["ngCookies"]).invoke(["$cookies",function(e){n=e}]);var o=n.get("curLocale")||"en";i===i?e.useUrlLoader("app/rest/localize/fixture/translate_"+o+".json"):e.useUrlLoader(t+"/atom/localize/"+o),e.preferredLanguage(o)}]).config(["$locationProvider",function(e){e.html5Mode(!0)}]).config(["$logProvider","$httpProvider","$stateProvider","toastr",function(e,t,i,n){t.defaults.headers.post={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},t.defaults.headers.get={Accept:"application/json"},t.interceptors.push(["$q","$injector","loginPeriod",function(e,t,i){return{request:function(e){var n=t.get("$cookies").get("rememberMe"),o=t.get("$cookies").get("token"),r=t.get("$cookies").get("homepage");if(o&&"0"===n){var s=new Date;s.setTime(s.getTime()+i);var a={expires:s,path:"/"};t.get("$cookies").put("token",o,a),t.get("$cookies").put("rememberMe",o,a),t.get("$cookies").put("homepage",r,a)}return e},responseError:function(i){return 500==i.status&&(t.get("$rootScope").errorMessage=i.data.error.message,t.get("$state").go("error500")),401==i.status?t.get("$state").go("logout"):400==i.status?i.data.error.message&&n.error(i.data.error.message):404==i.status?t.get("$rootScope").errorMessage=i.data.error.message:Lazy(i.data.error["null"]).each(function(e){e.message&&n.error(e.message)}),e.reject(i)}}}])}]).config(["toastr",function(e){e.options.timeOut=3e3,e.options.positionClass="toast-top-right",e.options.preventDuplicates=!1,e.options.closeButton=!0}])}(),angular.module("app").run(["$templateCache",function(e){e.put("app/components/localize/localize.html",'<ul class="nav navbar-nav navbar-right localize"><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false><img ng-src=app/assets/{{lang}}.gif>{{ currentLocale }}<span class=caret></span></a><ul class=dropdown-menu><li><a ng-click="changeLocale(\'en\')" href=#><img src=app/assets/en.gif> English</a></li><li><a ng-click="changeLocale(\'ru\')" href=#><img src=app/assets/ru.gif> Русский</a></li></ul></li></ul>'),e.put("app/directives/atomFieldBoolean/atomFieldBoolean.html",'<span class=input-group-addon><input type=checkbox id="{{ itemName }}" ng-model=field> </span>'),e.put("app/directives/atomFieldEntity/atomFieldEntity.html",'<select chosen no_results_text="\'Результат не найден\'" placeholder-text-multiple="\'Выберите один или несколько вариантов\'" placeholder-text-single="\'Выберите один вариант\'" multiple ng-options="b as b.title for b in list track by b.id" ng-model=entityModel[fieldName]><option value=""></option></select>'),e.put("app/directives/atomFieldString/atomFieldString.html",'<input autocomplete=off id="{{ itemName }}" placeholder="" type=text class=form-control ng-model=field>'),e.put("app/directives/atomFieldPassword/atomFieldPassword.html",'<input autocomplete=off id="{{ itemName }}" placeholder="" type=password class=form-control ng-model=field>'),e.put("app/directives/atomListField/atomListField.html","{{ fieldLabel }}"),e.put("app/modules/demo/demo.html","<div class=row><h1 class=demoTitle>DEMO</h1><p class=lead>Use this document as a way to quickly start any new project.<br>All you get is this text and a mostly barebones HTML document.</p><p class=lead localize>test</p></div>"),e.put("app/modules/page/page.html","<div class=pageContent ng-bind-html=pageContent></div>"),e.put("app/modules/errorPage/404.html",'<div class=page-err><div class="err-container text-center"><div class=err><div class=err-inner><h1>404</h1><h2>Not Found</h2></div></div><div class=err-mss><p>{{$root.errorMessage}}</p></div><div class=err-body><a ui-sref=app class="btn btn-lg btn-primary"><span class=space></span> Вернуться на главную</a></div></div><!--     <div class="footer text-center">\n            Copyright 2016 {{main.brand}} Admin\n        </div> --></div>'),e.put("app/modules/errorPage/500.html",'<div class=page-err><div class="err-container text-center"><div class=err><div class=err-inner><h1>500</h1><h2>Server Error</h2></div></div><div class=err-mss><p>{{$root.errorMessage}}</p></div><div class=err-body><a ui-sref=app class="btn btn-lg btn-primary"><span class=space></span> Вернуться на главную</a></div></div><!--     <div class="footer text-center">\n            Copyright 2016 {{main.brand}} Admin\n        </div> --></div>'),e.put("app/modules/authorization/signin/authorization.html",'<div class=page-signin><div class=main-body><div class=container><div class=form-container><form class=form-horizontal ng-submit=makeLogin() autocomplete=off><fieldset><input style=display:none> <input type=password style=display:none><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-envelope"></span></div><input type=email class="form-control input-lg input-round text-center" placeholder=Email ng-model=user.email></div><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-lock"></span></div><input type=password class="form-control input-lg input-round text-center" placeholder=Пароль ng-model=user.password></div><div class=form-group><label class="ui-checkbox rememberMeLabel"><input name=checkbox1 type=checkbox value=option2 ng-model=rememberMe> <span>Запомнить меня</span></label></div><div class=form-group><input type=submit class="btn btn-primary btn-lg btn-round btn-block text-center" value=Войти></div></fieldset></form></div></div></div></div>'),e.put("app/modules/authorization/signup/registration.html",'<div class=page-signin><div class=main-body><div class=container><div class=form-container><form class=form-horizontal ng-submit=makeRegistration() autocomplete=off><fieldset><input style=display:none> <input type=password style=display:none><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-envelope"></span></div><input type=email class="form-control input-lg input-round text-center" placeholder=Email ng-model=user.email></div><div class=form-group><div class="btn-icon-lined btn-icon-round btn-icon-sm btn-default-light"><span class="glyphicon glyphicon-lock"></span></div><input type=password class="form-control input-lg input-round text-center" placeholder=Пароль ng-model=user.password></div><div class=form-group><input type=submit class="btn btn-primary btn-lg btn-round btn-block text-center" value=Зарегистироваться></div></fieldset></form></div></div></div></div>'),e.put("app/modules/demo/read/demoRead.html","<h1>DEMO READ</h1><p class=lead translate>test</p>")}]);
//# sourceMappingURL=../../../maps/themes/frontend/scripts/app-f4794db3cd.js.map