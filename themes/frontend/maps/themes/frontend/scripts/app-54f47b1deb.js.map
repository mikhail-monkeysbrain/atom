{"version":3,"sources":["themes/frontend/scripts/app.js"],"names":["angular","module","config","$stateProvider","$urlRouterProvider","state","views","content@","templateUrl","controller","url","otherwise","$injector","get","go","$scope","$state","$location","EntityAPIService","$cookies","pageNotFound","locale","getTextPage","then","response","data","total","pageContent","en_content","content","abstract","$stateParams","$q","EntityService","entityName","all","getEntityDescription","getEntity","_id","responses","scheme","entityModels","entityTitle","title","entity","getLinkedEntities","linkedEntities","Lazy","each","save","entityData","$id","schemeItem","fieldName","type","item","n","id","saveEntity","reload","getEntityPage","page","limit","entities","remove","removeEntity","respons","AuthService","makeRegistration","register","user","success","toastr","message","error","$rootScope","$document","$http","SessionService","RestrictionsService","loginPeriod","baseURL","yearFuther","rememberMe","email","password","is","hidePanels","authorized","undefined","getSessionID","setSessionID","logout","resetPermissions","makeLogin","login","loginExpirationDate","Date","tokenCookieParams","path","setTime","getTime","expires","token","setUserID","userName","name","put","foo","$provide","decorator","$delegate","AuthServiceMock","debug","service","$httpParamSerializer","this","getRestrictions","RestrictionsAPIServiceMock","EntityAPIServiceMock","getEntities","getEntitiesList","filter","conditions","sort","sortOrder","isObject","i","sortField","searchKeywords","search","isNew","hasFileField","saveMethod","post","headers","X-Requested-With","Content-Type","Accept","exportEntity","length","push","element","form","html","cond","append","attr","action","submit","condition","queries","j","join","request","file","indexOf","properties","handleErrorPages","value","Session","getUserID","userId","expireDate","sessionId","RestrictionsAPIService","getPermissionsMap","isDefined","permissionsMap","when","hasPermissions","stateParts","split","routes","directive","$window","restrict","link","$element","attrs","changeText","lang","currentLocale","changeLocale","location","EntityServiceMock","map","model","compact","toArray","scope","field","linkedEntity","fields","find","findWhere","multiple","foundEntities","fieldItem","linkedItem","fieldLabel","format","moment","sec","showGlobalPopup","errorMessage","$uibModal","openDocumentPopup","open","animation","windowClass","size","resolve","$watch","console","log","$uibModalInstance","closePopup","dismiss","entityModel","list","entityItem","today","dt","datetimepicker","useCurrent","defaultDate","extraFormats","on","date","val","toString","replace","trigger","run","sessionID","$on","event","to","toParams","from","activePage","activeEntity","permission","authUrls","contains","constant","$translateProvider","injector","invoke","_$cookies_","useUrlLoader","preferredLanguage","$locationProvider","html5Mode","hostname","$logProvider","$httpProvider","defaults","interceptors","remember","homepage","responseError","rejection","status","reject","options","timeOut","positionClass","preventDuplicates","closeButton","$templateCache"],"mappings":"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","file":"themes/frontend/scripts/app-54f47b1deb.js","sourcesContent":["(function () {\n  'use strict';\n\n  angular\n    .module('page', [])\n    .config(function($stateProvider, $urlRouterProvider) {\n\n      $stateProvider\n        .state('customHandler', {\n          views: {\n            'content@': {\n              templateUrl: 'app/modules/page/page.html',\n              controller: 'CustomPageCtrl'\n            }\n          }\n        });\n\n      $stateProvider\n        .state('page', {\n          url:  '/page',\n          views: {\n            'content@': {\n              templateUrl: 'app/modules/page/page.html',\n              controller: 'TestPageCtrl'\n            }\n          }\n        });\n\n      $urlRouterProvider.otherwise(function($injector) {\n        $injector.get('$state').go('customHandler');\n      });\n\n    });\n\n})();\n(function () {\n  'use strict';\n\n  angular\n    .module('page')\n    .controller('CustomPageCtrl', function($scope, $state, $location, EntityAPIService, $cookies) {\n\n      var url = $location.url();\n      var locale = $cookies.get('curLocale') || 'ru';\n\n      EntityAPIService.getTextPage(url).then(function(response) {\n        if(response.data.total > 0) {\n          if(locale === 'en') {\n            $scope.pageContent = response.data.data[0].en_content;\n          } else {\n            $scope.pageContent = response.data.data[0].content;\n          }\n        } else {\n          pageNotFound();\n        }\n      });\n\n      function pageNotFound() {\n        if($state.get('error404') !== null) {\n          $state.go('error404');\n        } else {\n          $state.go('app');\n        }\n      }\n\n    });\n\n})();\n(function () {\n  'use strict';\n\n  angular\n    .module('log', [])\n    .config(function($stateProvider) {\n\n      $stateProvider\n        .state('app.log', {\n          url:      'log',\n          abstract: true\n        });\n\n      \n      $stateProvider\n        .state('app.log.index', {\n          url: '/'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/log/index/LogIndex.html'\n              , controller: 'LogIndexCtrl'\n            }\n          }\n        });\n      \n      $stateProvider\n        .state('app.log.create', {\n          url: '/create/'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/log/create/LogCreate.html'\n              , controller: 'LogCreateCtrl'\n            }\n          }\n        });\n      \n      $stateProvider\n        .state('app.log.read', {\n          url: '/{_id}/'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/log/read/LogRead.html'\n              , controller: 'LogReadCtrl'\n            }\n          }\n        });\n      \n      $stateProvider\n        .state('app.log.update', {\n          url: '/update/'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/log/update/LogUpdate.html'\n              , controller: 'LogUpdateCtrl'\n            }\n          }\n        });\n      \n      $stateProvider\n        .state('app.log.delete', {\n          url: '/delete/'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/log/delete/LogDelete.html'\n              , controller: 'LogDeleteCtrl'\n            }\n          }\n        });\n      \n      ;\n    });\n\n})();\n(function () {\r\n'use strict';\r\n\r\nangular\r\n  .module('log')\r\n  .controller('LogReadCtrl', function($scope, $stateParams, $q, EntityService, EntityAPIService) {\r\n\r\n    var page = 0;\r\n    var limit = 0;\r\n    var entityName = 'log';\r\n\r\n    $q.all([\r\n      EntityAPIService.getEntityDescription(entityName),\r\n      EntityAPIService.getEntity(entityName, $stateParams._id)\r\n    ]).then(function(responses) {\r\n      var scheme = responses[0].data['log'].scheme;\r\n      $scope.entityModels = {};\r\n      $scope.entityTitle = responses[0].data['log'].title;\r\n      var entity = responses[1].data.data[0];\r\n\r\n      EntityService.getLinkedEntities(scheme).then(function(responses) {\r\n\r\n        var linkedEntities = {};\r\n        Lazy(responses).each(function(response) {\r\n          linkedEntities[response.entity] = response;\r\n        });\r\n\r\n        $scope.linkedEntities = linkedEntities;\r\n\r\n        $scope.entity = entity;\r\n        $scope.scheme = scheme;\r\n\r\n      });\r\n    });\r\n\r\n    $scope.save = function() {\r\n\r\n      var entityData = {\r\n        '_id': $scope.entity._id.$id\r\n      };\r\n\r\n\r\n      Lazy($scope.scheme).each(function(schemeItem, fieldName) {\r\n        if(schemeItem.type !== 'entity') {\r\n          entityData[fieldName] = $scope.entity[fieldName]\r\n        } else {\r\n          Lazy($scope.entityModels[fieldName]).each(function(item, n) {\r\n            entityData[fieldName + '[' + n + ']'] = item.id;\r\n          });\r\n        }\r\n      });\r\n\r\n      EntityAPIService.saveEntity(entityName, entityData, false);\r\n    };\r\n\r\n});\r\n\r\n})();\n(function () {\n'use strict';\n\nangular\n  .module('log')\n  .controller('LogIndexCtrl', function($scope, $q, EntityService, EntityAPIService) {\n\n    var page = 0;\n    var limit = 0;\n    var entityName = 'log';\n\n    reload();\n\n\n    $scope.remove = function(_id) {\n      EntityAPIService.removeEntity(entityName, {_id: _id}).then(function() {\n        reload();\n      });\n    };\n\n    function reload() {\n      $q.all([\n        EntityAPIService.getEntityDescription(entityName),\n        EntityAPIService.getEntityPage(entityName, page, limit)\n      ]).then(function(responses) {\n        $scope.scheme = responses[0].data[entityName].scheme;\n        $scope.entityTitle = responses[0].data[entityName].title;\n        var entities = responses[1].data.data;\n\n        EntityService.getLinkedEntities($scope.scheme).then(function(responses) {\n\n          var linkedEntities = {};\n          Lazy(responses).each(function(response) {\n            linkedEntities[response.entity] = response;\n          });\n\n          $scope.linkedEntities = linkedEntities;\n\n          $scope.entities = entities;\n        });\n      });\n    }\n\n});\n\n})();\n(function () {\r\n'use strict';\r\n\r\nangular\r\n  .module('log')\r\n  .controller('LogCreateCtrl', function($scope, $stateParams, $q, EntityService, EntityAPIService) {\r\n\r\n    var page = 0;\r\n    var limit = 0;\r\n    var entityName = 'log';\r\n    $scope.entity = {};\r\n\r\n    EntityAPIService.getEntityDescription(entityName).then(function(respons) {\r\n      var scheme = respons.data['user'].scheme;\r\n      $scope.entityModels = {};\r\n      $scope.entityTitle = respons.data['user'].title;\r\n\r\n      EntityService.getLinkedEntities(scheme).then(function(responses) {\r\n\r\n        var linkedEntities = {};\r\n        Lazy(responses).each(function(response) {\r\n          linkedEntities[response.entity] = response;\r\n        });\r\n\r\n        $scope.linkedEntities = linkedEntities;\r\n\r\n        $scope.scheme = scheme;\r\n\r\n      });\r\n    });\r\n\r\n    $scope.save = function() {\r\n\r\n      var entityData = {};\r\n\r\n      Lazy($scope.scheme).each(function(schemeItem, fieldName) {\r\n        if(schemeItem.type !== 'entity') {\r\n          entityData[fieldName] = $scope.entity[fieldName]\r\n        } else {\r\n          Lazy($scope.entityModels[fieldName]).each(function(item, n) {\r\n            entityData[fieldName + '[' + n + ']'] = item.id;\r\n          });\r\n        }\r\n      });\r\n\r\n      EntityAPIService.saveEntity(entityName, entityData, true);\r\n    };\r\n\r\n});\r\n\r\n})();\n(function() {\n'use strict';\n\n  angular.module('authorization', [])\n    .config(function($stateProvider) {\n\n//TODO: Refactor!\n      $stateProvider\n        .state('login', {\n          url: '/login',\n          views: {\n            'content@': {\n              templateUrl:  'app/modules/authorization/signin/authorization.html',\n              controller: 'AuthorizationCtrl'\n            }\n          }\n        })\n        .state('logout', {\n          url: '/logout',\n          views: {\n            'content@': {\n              templateUrl:  'app/modules/authorization/signin/authorization.html',\n              controller: 'AuthorizationCtrl'\n            }\n          }\n        })\n        .state('register', {\n          url: '/signup',\n          views: {\n            'content@': {\n              templateUrl:  'app/modules/authorization/signup/registration.html',\n              controller: 'RegistrationCtrl'\n            }\n          }\n        })\n        ;\n    })\n    ;\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('authorization')\n    .controller('RegistrationCtrl', function($scope, $state, AuthService) {\n\n      $scope.makeRegistration = function() {\n        AuthService.register($scope.user).then(function(response) {\n\n          if(response.data.success) {\n            toastr.success(response.data.success.message);\n            $state.go('login');\n          } else {\n            toastr.error(response.data.error.message);\n          }\n        });\n      };\n\n    });\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('authorization')\n    .controller('AuthorizationCtrl', function($scope, $rootScope, $state, $document, $http, $cookies, AuthService, toastr, SessionService, RestrictionsService, $stateParams, loginPeriod, baseURL) {\n\n      var yearFuther = 1000*60*60*24*365;\n      $scope.rememberMe = true;\n\n      //TODO: FOr development\n      $scope.user = {\n        email: 'kamal@hismith.ru',\n        password: 'multipass'\n      }\n\n      if($state.is('logout')) {\n        $rootScope.hidePanels = true;\n        $rootScope.authorized = false;\n        if(SessionService.getSessionID() !== undefined) {\n          SessionService.setSessionID(undefined);\n          AuthService.logout().then(function() {\n            $cookies.remove('token');\n            $cookies.remove('rememberMe');\n            RestrictionsService.resetPermissions().then(function() {\n              $state.go('app');\n            });\n          });\n        }\n        $state.go('login');\n      }\n\n      $scope.makeLogin = function() {\n        AuthService.login($scope.user)\n          .then(function(response) {\n            if(response.data.success) {\n\n              var loginExpirationDate = new Date();\n              var tokenCookieParams = {\n                path: '/'\n              };\n\n              if($scope.rememberMe) {\n                loginExpirationDate.setTime( loginExpirationDate.getTime() + yearFuther );\n              }else{\n                loginExpirationDate.setTime( loginExpirationDate.getTime() + loginPeriod );\n              }\n\n              tokenCookieParams.expires = loginExpirationDate;\n\n\n              SessionService.setSessionID(response.data.success.user.token);\n              SessionService.setUserID(response.data.success.user._id.$id);\n              toastr.success(response.data.success.message);\n\n              $rootScope.authorized = true;\n              $rootScope.userName = response.data.success.user.name;\n              $cookies.put('token', response.data.success.user.token, tokenCookieParams);\n              $cookies.put('rememberMe', $scope.rememberMe ? 1 : 0, tokenCookieParams);\n\n              RestrictionsService.resetPermissions().then(function() {\n                $state.go('app');\n              });\n\n\n            } else {\n              toastr.error(response.data.error.message);\n            }\n          })\n\n      };\n    });\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('demo', [])\n    .config(function($stateProvider) {\n\n      $stateProvider\n        .state('app.demo', {\n          url:        'demo'\n          , abstract: true\n        })\n      ;\n\n      $stateProvider\n        .state('app.demo.index', {\n          url: ''\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/demo/demo.html'\n              , controller: 'DemoCtrl'\n            }\n          }\n        })\n        .state('app.demo.read', {\n          url: '/:id'\n          , views: {\n            'content@': {\n              templateUrl:  'app/modules/demo/read/demoRead.html'\n              , controller: 'DemoReadCtrl'\n            }\n          }\n        })\n      ;\n    });\n\n})();\n(function () {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('demo')\r\n    .controller('DemoReadCtrl', function($scope) {\r\n\r\n      $scope.foo = 'test'\r\n\r\n    });\r\n\r\n})();\n(function() {\n  'use strict';\n\n  angular.module('rest.auth', [])\n    .config(function($provide) {\n      $provide.decorator('AuthService', function($delegate, $location, AuthServiceMock, debug) {\n        if (debug) {\n          $delegate = AuthServiceMock;\n        }\n        return $delegate;\n      });\n    })\n  ;\n\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('rest.auth')\r\n    .service('RestrictionsAPIService', function($http, $httpParamSerializer, baseURL) {\r\n\r\n      this.getRestrictions = function() {\r\n        return $http.get(baseURL + '/atom/entities/?fields=routes');\r\n      };\r\n\r\n    });\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('rest.restrictionsAPI', [])\r\n    .config(function($provide) {\r\n      $provide.decorator('RestrictionsAPIService', function($delegate, $location, RestrictionsAPIServiceMock, debug) {\r\n        if (debug) {\r\n          $delegate = RestrictionsAPIServiceMock;\r\n        }\r\n        return $delegate;\r\n      });\r\n    })\r\n  ;\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('rest.restrictionsAPI')\r\n    .service('RestrictionsAPIServiceMock', function($http) {\r\n\r\n      this.getRestrictions = function() {\r\n        return $http.get('/app/rest/restrictions/fixture/restrictions.json');\r\n      };\r\n\r\n    });\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular.module('rest.entity', [])\n    .config(function($provide) {\n      $provide.decorator('EntityAPIService', function($delegate, EntityAPIServiceMock, debug) {\n        if (debug) {\n          $delegate = EntityAPIServiceMock;\n        }\n        return $delegate;\n      });\n    })\n  ;\n\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('rest.entity')\n    .service('EntityAPIServiceMock', function($http, $httpParamSerializer) {\n\n      this.getEntities = function() {\n        return $http.get('/app/rest/entity/fixture/entities.json');\n      };\n\n      this.getEntitiesList = function(entity) {\n        return $http.get('/app/rest/entity/fixture/usersList.json');\n      };\n\n      this.getEntityDescription = function(entity) {\n        return $http.get('/app/rest/entity/fixture/usersDescription.json');\n      };\n\n      this.getEntityPage = function(entity, page, limit) {\n        if(page === 0) {\n          return $http.get('/app/rest/entity/fixture/usersPage1.json');\n        } else {\n          return $http.get('/app/rest/entity/fixture/usersPage2.json');\n        }\n      };\n\n      this.getEntity = function(entity, id) {\n        return $http.get('/app/rest/entity/fixture/userExample.json');\n      };\n\n      this.saveEntity = function(entity, data) {\n        return $http.get('/app/rest/entity/fixture/userSaved.json', $httpParamSerializer(data));\n      };\n\n      this.removeEntity = function(entity, data) {\n        return $http.get('/app/rest/entity/fixture/userSaved.json', $httpParamSerializer(data));\n      };\n\n      this.getTextPage = function(url) {\n        if(url == '/page1') {\n          return $http.get('app/rest/entity/fixture/page.json');\n        } else {\n          return $http.get('app/rest/entity/fixture/pageNotFound.json');\n        }\n      }\n\n    });\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('rest.entity')\n    .service('EntityAPIService', function($http, $httpParamSerializer, baseURL) {\n      var service = this;\n      this.getEntities = function(filter) {\n        var conditions = filter ? '?condition[name]=' + filter : '';\n        return $http.get(baseURL + '/atom/entities/' + conditions);\n      };\n\n      this.getEntitiesList = function(entity, limit, sort) {\n        limit = limit || 0;\n        var sortOrder = '';\n        if(angular.isObject(sort)) {\n          for(var i in sort) {\n            sortOrder += '&sort[' + i + ']=' + sort[i];\n          }\n        }\n\n        return $http.get(baseURL + '/' + entity + \"/?condition[enabled][$ne]=null&limit=\" + limit + sortOrder);\n      };\n\n      this.getEntityDescription = function(entity) {\n        return service.getEntities(entity);\n        //return $http.get(baseURL + '/atom/entities/' + entity + '/');\n      };\n\n      this.getEntityPage = function(entity, page, limit, sortField, sortOrder, searchKeywords) {\n        var sort = !!(sortField && sortOrder) ? '&sort[' + sortField + ']=' + sortOrder : '';\n        var search = !!searchKeywords ? '&condition[$search]=' + searchKeywords : '';\n        return $http.get(baseURL + '/' + entity + '/page/' + page + '/?condition[enabled][$ne]=null&limit=' + limit + sort + search);\n      };\n\n      this.getEntity = function(entity, id) {\n        return $http.get(baseURL + '/' + entity + '/' + id + '/');\n      };\n\n      this.saveEntity = function(entity, data, isNew, hasFileField) {\n        var saveMethod = typeof data._id === 'undefined' && isNew ? 'create' : 'update';\n\n        if(hasFileField){\n          return $http.post(baseURL + '/' + entity + '/' + saveMethod + '/', data, {headers: {\n            'X-Requested-With': 'XMLHttpRequest'\n            , 'Content-Type':     undefined\n            , 'Accept':           'application/json'\n          }} );\n        } else {\n          return $http.post(baseURL + '/' + entity + '/' + saveMethod + '/', $httpParamSerializer(data));\n        }\n\n      };\n\n      this.removeEntity = function(entity, data) {\n        return $http.post(baseURL + '/' + entity + '/delete/', $httpParamSerializer(data));\n      };\n\n      this.exportEntity = function(entity, data, sortField, sortOrder) {\n        var conditions = [];\n        //var condition = 'condition[_id][$in][]=561fe8ae572b94d3358b4567&condition[_id][$in][]=5613e72e572b94274d8b4567&condition[_id][$in][]=5613e6e3572b94114d8b4567';\n        if(data.length) {\n          for(var i = 0; i < data.length; i++) {\n            conditions.push(angular.element('<input type=\"hidden\" name=\"condition[_id][$in][]\" value=\"' + data[i] + '\">'));\n          }\n        }\n\n\n        var form = angular.element('#downloadForm');\n        form.html('');\n        var limit = angular.element('<input type=\"hidden\" name=\"limit\" value=\"0\">');\n        var sort = !!(sortField && sortOrder) ? angular.element('<input type=\"hidden\" name=\"sort[' + sortField + ']\" value=\"' + sortOrder + '\">') : '';\n        Lazy(conditions).each(function(cond) {\n          form.append(cond);\n        });\n        form.append(limit);\n        form.append(sort);\n        form.attr({\n          action: '/' + entity + '/export/'\n        })[0].submit();\n      };\n\n      this.getLinkedEntities = function(entity, data) {\n        var condition = [];\n        var queries = [];\n        if(data.length) {\n          var i, j;\n          for(i = 0, j = 0; i < data.length; i++, j++) {\n            if (data[i]) {\n              condition.push('condition[_id][$in][]=' + data[i].$id);\n            }\n            if(j == 19 || i == data.length-1) {\n              condition = condition.join('&');\n              queries.push($http.get(baseURL + '/' + entity + '/?' + condition + '&limit=0'));\n              j = -1;\n              condition = [];\n            }\n          }\n        }\n\n        return queries;\n      };\n\n      this.getTextPage = function(url) {\n        return $http.get(baseURL + '/page/?limit=0&condition[url]=' + url);\n      }\n    });\n\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('rest.auth')\n    .service('AuthServiceMock', function($http) {\n      this.logout = function() {\n        return $http.get('/app/rest/auth/fixture/logout_success.json');\n      };\n\n      this.login = function(request) {\n\n        var file = (request.email.indexOf('test') === 0)\n          ? 'auth.json'\n          : 'auth_fail.json'\n          ;\n\n        return $http.get('/app/rest/auth/fixture/' + file);\n      };\n\n      this.register = function(request) {\n\n        var file = (request.email.indexOf('test') === 0)\n            ? 'register.json'\n            : 'register_fail.json'\n          ;\n\n        return $http.get('/app/rest/auth/fixture/' + file);\n      };\n\n    });\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('rest.auth')\n    .service('AuthService', function($http, $httpParamSerializer, baseURL) {\n      this.logout = function() {\n        return $http.get(baseURL + '/user/logout/');\n      };\n\n      this.login = function(request) {\n        return $http.post(baseURL + '/user/auth/pass/', $httpParamSerializer(request));\n      };\n\n      this.register = function(request) {\n        return $http.post(baseURL + '/user/auth/register/', $httpParamSerializer(request));\n      };\n\n\n      this.properties = function() {\n        return $http.get(baseURL + '/atom/properties/');\n      };\n\n    });\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('page')\n    .controller('TestPageCtrl', function($scope) {\n\n      $scope.pageContent = 'test page'\n\n    });\n\n})();\n(function() {\n  'use strict';\n\n  angular.module('errorPage', [ ])\n    .config(function($stateProvider) {\n\n      $stateProvider\n        .state('error500', {\n          views: {\n            'content@': {\n              templateUrl:  'app/modules/errorPage/500.html',\n              controller: 'ErrorPageCtrl'\n            }\n          }\n        })\n      ;\n\n      $stateProvider\n        .state('error404', {\n          views: {\n            'content@': {\n              templateUrl:  'app/modules/errorPage/404.html',\n              controller: 'ErrorPageCtrl'\n            }\n          }\n        })\n      ;\n    })\n  ;\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('errorPage')\n    .controller('ErrorPageCtrl', function($scope, $state, handleErrorPages) {\n      if(!handleErrorPages) {\n        $state.go('app');\n      }\n    });\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('demo')\n    .controller('DemoCtrl', function($scope) {\n\n      $scope.foo = 'test'\n\n    });\n\n})();\n(function() {\n  'use strict';\n\n  angular.module('components.session', [])\n    .value('Session', {});\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('components.session')\n    .service('SessionService', function SessionService($cookies, Session) {\n\n      this.getUserID = function() {\n        return $cookies.get('userId');\n      };\n\n      this.setUserID = function(userId) {\n        var expireDate = new Date();\n        expireDate.setTime(expireDate.getTime() + 3*60*60*1000);\n        return $cookies.put('userId', userId, { expires: expireDate });\n      };\n\n      this.setSessionID = function(sessionId) {\n        //TODO: Remove storage in cookies for prod\n        var expireDate = new Date();\n        expireDate.setTime(expireDate.getTime() + 3*60*60*1000);\n        return $cookies.put('sessionId', sessionId, { expires: expireDate });\n      };\n\n      this.getSessionID = function() {\n        return $cookies.get('sessionId');\n      };\n\n    });\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('components.restrictions', [])\r\n\r\n})();\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('components.restrictions')\r\n    .service('RestrictionsService', function RestrictionsService($q, RestrictionsAPIService) {\r\n\r\n      var service = this;\r\n\r\n      this.hasPermissions = function(state) {\r\n        return getPermissionsMap().then(function(permissionsMap) {\r\n          var stateParts = state.split('.');\r\n\r\n          if(stateParts.length === 1){\r\n            return true;\r\n          }\r\n\r\n          var entity = stateParts[1];\r\n          var action = stateParts[2];\r\n          if(entity) {\r\n            if(permissionsMap[entity]){\r\n              return angular.isDefined(permissionsMap[entity].routes[entity + '.' + action]);\r\n            }\r\n          }\r\n          return false;\r\n        })\r\n      };\r\n\r\n      this.resetPermissions = function() {\r\n        return RestrictionsAPIService.getRestrictions().then(function(response) {\r\n          service.permissionsMap = response.data;\r\n          return service.permissionsMap;\r\n        });\r\n      };\r\n\r\n\r\n      function getPermissionsMap() {\r\n        if(angular.isDefined(service.permissionsMap)) {\r\n          return $q.when(service.permissionsMap);\r\n        } else {\r\n          return RestrictionsAPIService.getRestrictions().then(function(response) {\r\n            service.permissionsMap = response.data;\r\n            return service.permissionsMap;\r\n          });\r\n        }\r\n      }\r\n\r\n    });\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular.module('components.localize', ['ngCookies']);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('components.localize')\n    .directive('localize', function($cookies, $window) {\n\n      return {\n        restrict:    'E',\n        templateUrl: 'app/components/localize/localize.html',\n        link: function($scope, $element, attrs) {\n          $scope.lang = $cookies.get('curLocale') || 'ru';\n          changeText();\n\n          $scope.changeLocale = function(locale) {\n            if($scope.lang !== locale) {\n              $scope.lang = locale;\n              $cookies.put('curLocale', locale);\n              changeText();\n              $window.location.reload();\n            }\n          };\n\n          function changeText() {\n            if($scope.lang == 'en') {\n              $scope.currentLocale = 'English';\n            } else {\n              $scope.currentLocale = 'Русский';\n            }\n          }\n\n        }\n      };\n    });\n\n})();\n\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('components.entity', [])\r\n    .config(function($provide) {\r\n      $provide.decorator('EntityService', function($delegate, EntityServiceMock, debug) {\r\n        if (debug) {\r\n          $delegate = EntityServiceMock;\r\n        }\r\n        return $delegate;\r\n      });\r\n    })\r\n  ;\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('components.entity')\r\n    .service('EntityServiceMock', function($http, $httpParamSerializer) {\r\n\r\n\r\n    });\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('components.entity')\r\n    .service('EntityService', function($q, EntityAPIService) {\r\n      var service = this;\r\n\r\n      service.getLinkedEntities = function(scheme) {\r\n        var entities = Lazy(scheme)\r\n          .map(function(item) {\r\n            if(item.type === 'entity') {\r\n              return EntityAPIService.getEntitiesList(item.entity.model, 0, 0).then(function(response) {\r\n                return {\r\n                  entity: item.entity.model,\r\n                  data: response.data\r\n                };\r\n              });\r\n            }\r\n          })\r\n          .compact()\r\n          .toArray();\r\n\r\n        return $q.all(entities);\r\n      };\r\n    });\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomListField', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomListField')\r\n    .directive('atomListField', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '=',\r\n          linkedEntity: '='\r\n        },\r\n        templateUrl: 'app/directives/atomListField/atomListField.html',\r\n        link: function($scope, $element, attrs) {\r\n          if($scope.scheme.type === 'entity') {\r\n            var linkedEntity = Lazy($scope.linkedEntity.data.data).find(function (item) {\r\n              return Lazy($scope.field).findWhere({$id: item._id.$id});\r\n            });\r\n\r\n            var fields = $scope.scheme.multiple ? $scope.field : [$scope.field];\r\n\r\n            var foundEntities = Lazy(fields)\r\n              .map(function(fieldItem) {\r\n                return Lazy($scope.linkedEntity.data.data).find(function(linkedItem) {\r\n                  return linkedItem._id.$id === fieldItem.$id;\r\n                } || {}).title;\r\n              })\r\n              .compact()\r\n              .toArray();\r\n\r\n            $scope.fieldLabel = foundEntities.join(', ');\r\n          } else if($scope.scheme.type === 'date' || $scope.scheme.type === 'time' || $scope.scheme.type === 'datetime') {\r\n\r\n            var format = $scope.scheme.type === 'time' ? 'HH:mm' : ($scope.scheme.type === 'date' ? 'DD.MM.YYYY' : 'DD.MM.YYYY HH:mm');\r\n\r\n            $scope.fieldLabel = moment($scope.field.sec * 1000).format(format);\r\n          } else {\r\n            $scope.fieldLabel = $scope.field;\r\n          }\r\n        }\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\n  'use strict';\n\n  angular.module('directives.atomGlobalPopup', []);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('directives.atomGlobalPopup')\n    .directive('atomGlobalPopup', function() {\n\n      return {\n        restrict:    'AEC',\n        scope: {\n          showGlobalPopup: '=',\n          errorMessage: '='\n        },\n        controller: function($scope, $uibModal) {\n\n        $scope.$watch('showGlobalPopup', function() {\n          console.log('showGlobalPopup', $scope.showGlobalPopup);\n          if ($scope.showGlobalPopup) {\n            $scope.showGlobalPopup = false;\n\n            openDocumentPopup();\n          }\n        });\n\n        function openDocumentPopup() {\n          var modalInstance = $uibModal.open({\n            animation:     true\n            , templateUrl: 'app/directives/atomGlobalPopup/atomGlobalPopup.html'\n            , windowClass: 'customModal'\n            , controller:  'AtomGlobalPopupCtrl'\n            , size:        'sm'\n            , scope:       $scope\n            , resolve:     {}\n          });\n\n          //modalInstance.result.then($scope.savePopupAction);\n        }\n\n      }\n      };\n    });\n\n})();\n\n\n(function() {\n  'use strict';\n\n  angular.module('directives.atomGlobalPopup')\n    .controller('AtomGlobalPopupCtrl', function(\n      $scope,\n      $uibModalInstance\n    ) {\n\n\n      $scope.closePopup = function() {\n        $uibModalInstance.dismiss('cancel');\n      };\n\n\n    });\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldString', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldString')\r\n    .directive('atomFieldString', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '='\r\n        },\r\n        templateUrl: 'app/directives/atomFieldString/atomFieldString.html',\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldPassword', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldPassword')\r\n    .directive('atomFieldPassword', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '='\r\n        },\r\n        templateUrl: 'app/directives/atomFieldPassword/atomFieldPassword.html',\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldEntity', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldEntity')\r\n    .directive('atomFieldEntity', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '=',\r\n          linkedEntity: '=',\r\n          entityModel: '='\r\n        },\r\n        templateUrl: 'app/directives/atomFieldEntity/atomFieldEntity.html',\r\n        link: function($scope) {\r\n\r\n          $scope.entityModel[$scope.fieldName] = $scope.entityModel[$scope.fieldName] || [];\r\n\r\n          var list = Lazy($scope.linkedEntity.data.data).map(function(item) {\r\n            return {\r\n              title: item.title,\r\n              id: item._id.$id\r\n            }\r\n          }).toArray();\r\n\r\n\r\n          var fields = $scope.scheme.multiple ? $scope.field : [$scope.field];\r\n\r\n          var model = Lazy(fields).map(function(fieldItem) {\r\n              return Lazy(list).find(function(entityItem) {\r\n                return entityItem.id === fieldItem.$id;\r\n              })\r\n            })\r\n            .compact()\r\n            .toArray();\r\n\r\n          $scope.entityModel[$scope.fieldName] = $scope.scheme.multiple ? model : model[0];\r\n\r\n          $scope.list = list;\r\n        }\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldDatetime', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldDatetime')\r\n    .directive('atomFieldDatetime', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '='\r\n        },\r\n        templateUrl: 'app/directives/atomFieldDatetime/atomFieldDatetime.html',\r\n        link: function($scope, $element) {\r\n\r\n          var format = $scope.scheme.type === 'time' ? 'HH:mm' : ($scope.scheme.type === 'date' ? 'DD.MM.YYYY' : 'DD.MM.YYYY HH:mm');\r\n\r\n\r\n          $scope.today = function() {\r\n            $scope.dt = new Date();\r\n            return $scope.dt;\r\n          };\r\n\r\n\r\n\r\n          $scope.dt = moment($scope.field.sec * 1000);\r\n\r\n\r\n          $element.datetimepicker({\r\n            locale: 'ru',\r\n            useCurrent: true,\r\n            defaultDate: $scope.dt,\r\n            format: format,\r\n            extraFormats: [format ]\r\n          });\r\n\r\n\r\n\r\n          $scope.$watch('dt', function() {\r\n            console.log('dt', $scope.dt);\r\n          });\r\n\r\n          $element.find('input').on('blur', function () {\r\n\r\n            var date = moment($element.find('input').val(), format);\r\n\r\n            $scope.field = (date).toString().replace(/( \\((.+)\\))/g, '');\r\n            $element.find('input').trigger('input');\r\n          })\r\n\r\n        }\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldBoolean', []);\r\n\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular.module('directives.atomFieldBoolean')\r\n    .directive('atomFieldBoolean', function() {\r\n\r\n      return {\r\n        restrict:    'A',\r\n        scope: {\r\n          scheme:    '=',\r\n          fieldName: '=',\r\n          field:     '='\r\n        },\r\n        templateUrl: 'app/directives/atomFieldBoolean/atomFieldBoolean.html',\r\n      };\r\n    });\r\n\r\n})();\r\n\r\n\n(function() {\n  'use strict';\n\n  angular.module('app', [\n    'ui.router',\n    'ui.bootstrap',\n    'ngAnimate',\n    'ngTouch',\n    'ngCookies',\n    'ngSanitize',\n    'pascalprecht.translate',\n    'localytics.directives',\n\n    'components.session',\n    'components.restrictions',\n    'components.localize',\n    'components.entity',\n\n    'directives.atomListField',\n    'directives.atomFieldString',\n    'directives.atomFieldPassword',\n    'directives.atomFieldBoolean',\n    'directives.atomFieldEntity',\n    'directives.atomFieldDatetime',\n    'directives.atomGlobalPopup',\n\n    'rest.auth',\n    'rest.restrictionsAPI',\n    'rest.entity',\n\n    'log',\n\n    'demo',\n    'authorization',\n    'page',\n    'errorPage'\n  ]);\n})();\n(function() {\n  'use strict';\n\n  angular.module('app')\n    .run(function($rootScope, $state, $http, SessionService, RestrictionsService) {\n\n      var sessionID = SessionService.getSessionID();\n\n      if(sessionID) {\n        $rootScope.authorized = true;\n      }\n\n      $rootScope.$on('$stateChangeSuccess', function(event, to, toParams, from) {\n\n        $rootScope.activePage = to.name;\n        $rootScope.activeEntity = to.name === 'pagesList' ? 'page' : toParams.entity;\n\n        if(from.name == \"error500\") {\n          $rootScope.activePage = to.name;\n          $rootScope.activeEntity = toParams.entity;\n          $rootScope.hidePanels = false;\n        }\n\n        RestrictionsService.hasPermissions(to.name).then(function(permission) {\n          if(!permission) {$state.go('app')};\n        });\n\n        var authUrls = [ 'login', 'logout' ],\n          sessionID = SessionService.getSessionID();\n\n        //if(sessionID){\n        //  $rootScope.authorized = true;\n        //  EntityService.getEntity('user', SessionService.getUserID()).then(function(response) {\n        //    if(response.data.error && response.data.error.code == 403) {\n        //      $state.go('logout');\n        //    } else {\n        //      $rootScope.userName = response.data.data[0].title;\n        //    }\n        //  }, function() {\n        //    $state.go('logout');\n        //  });\n        //}\n\n        if (!Lazy(authUrls).contains(to.name) && !sessionID) {\n          //$state.go('logout');\n        }\n\n        if (sessionID && to.name === 'login') {\n          $state.go('app');\n        }\n      });\n\n    })\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .constant('toastr', toastr)\n    .constant('baseURL', '')\n    .constant('debug', false)\n    .constant('handleErrorPages', true)\n    .constant('loginPeriod', (30*60*1000) );\n\n})();\n(function() {\n  'use strict';\n\n  angular.module('app')\n\n    .config(function($stateProvider, $urlRouterProvider) {\n      $stateProvider\n        .state('app', {\n          url:        '/'\n        })\n      ;\n\n      $urlRouterProvider.otherwise(function($injector) {\n        $injector.get('$state').go('customHandler');\n      });\n    })\n\n    .config(function($translateProvider, baseURL, debug) {\n      var $cookies;\n      angular.injector(['ngCookies']).invoke(['$cookies', function(_$cookies_) {\n        $cookies = _$cookies_;\n      }]);\n\n      var lang = $cookies.get('curLocale') || 'en';\n      if(debug) {\n        $translateProvider.useUrlLoader('app/rest/localize/fixture/translate_' + lang + '.json');\n      } else {\n        $translateProvider.useUrlLoader(baseURL + '/atom/locales/?condtition[locale]=' + lang);\n      }\n      $translateProvider.preferredLanguage(lang);\n    })\n\n    .config(function($locationProvider) {\n      //TODO: Comment for development. There are problems with proxy in HTML5mode\n      $locationProvider.html5Mode(location.hostname !== 'localhost');\n    })\n\n    .config(function($logProvider, $httpProvider, $stateProvider, toastr) {\n\n      $httpProvider.defaults.headers.post = {'Accept': 'application/json', 'Content-Type': 'application/x-www-form-urlencoded'};\n      $httpProvider.defaults.headers.get = {'Accept': 'application/json'};\n\n      $httpProvider.interceptors.push(function($q, $injector, loginPeriod) {\n        return {\n          request: function(config) {\n            var remember = $injector.get('$cookies').get('rememberMe');\n            var token = $injector.get('$cookies').get('token');\n            var homepage = $injector.get('$cookies').get('homepage');\n\n            if(token && remember === '0') {\n              var loginExpirationDate = new Date();\n              loginExpirationDate.setTime( loginExpirationDate.getTime() + loginPeriod );\n              var tokenCookieParams = {\n                expires: loginExpirationDate,\n                path: '/'\n              };\n              $injector.get('$cookies').put('token', token, tokenCookieParams);\n              $injector.get('$cookies').put('rememberMe', token, tokenCookieParams);\n              $injector.get('$cookies').put('homepage', homepage, tokenCookieParams);\n            }\n\n            return config;\n          },\n          responseError:  function(rejection) {\n            if(rejection.status == 500){\n              $injector.get('$rootScope').errorMessage = rejection.data.error.message;\n              $injector.get('$rootScope').showGlobalPopup = true;\n            }\n            if(rejection.status == 401) {\n              $injector.get('$state').go('logout');\n            } else if(rejection.status == 400) {\n              if(rejection.data.error.message)\n                toastr.error(rejection.data.error.message);\n            } else if(rejection.status == 404) {\n              $injector.get('$rootScope').errorMessage = rejection.data.error.message;\n              $injector.get('$rootScope').showGlobalPopup = true;\n            } else {\n              Lazy(rejection.data.error.null).each(function(error) {\n                if(error.message)\n                  toastr.error(error.message);\n              });\n            }\n\n            return $q.reject(rejection);\n          }\n        };\n      });\n\n    })\n\n    .config(function(toastr) {\n      toastr.options.timeOut = 3000;\n      toastr.options.positionClass = 'toast-top-right';\n      toastr.options.preventDuplicates = false;\n      toastr.options.closeButton = true;\n    });\n})();\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/localize/localize.html\",\"<ul class=\\\"nav navbar-nav navbar-right localize\\\"><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false><img ng-src=app/assets/{{lang}}.gif>{{ currentLocale }}<span class=caret></span></a><ul class=dropdown-menu><li><a ng-click=\\\"changeLocale(\\'en\\')\\\" href=#><img src=app/assets/en.gif> English</a></li><li><a ng-click=\\\"changeLocale(\\'ru\\')\\\" href=#><img src=app/assets/ru.gif> Русский</a></li></ul></li></ul>\");\n$templateCache.put(\"app/directives/atomFieldBoolean/atomFieldBoolean.html\",\"<span class=input-group-addon><input type=checkbox id=\\\"{{ itemName }}\\\" ng-model=field> </span>\");\n$templateCache.put(\"app/directives/atomFieldDatetime/atomFieldDatetime.html\",\"<input type=text class=form-control id={{fieldName}} name={{fieldName}}> <span class=input-group-addon><i class=fa ng-class=\\\"{\\r\\n    \\'fa-calendar\\': (scheme.type === \\'date\\' || scheme.type === \\'datetime\\'),\\r\\n    \\'fa-clock-o\\':  scheme.type === \\'time\\'\\r\\n    }\\\"></i> </span>\");\n$templateCache.put(\"app/directives/atomFieldEntity/atomFieldEntity.html\",\"<select ng-if=scheme.multiple chosen no_results_text=\\\"\\'Результат не найден\\'\\\" placeholder-text-multiple=\\\"\\'Выберите один или несколько вариантов\\'\\\" placeholder-text-single=\\\"\\'Выберите один вариант\\'\\\" multiple ng-options=\\\"b as b.title for b in list track by b.id\\\" ng-model=entityModel[fieldName]><option value=\\\"\\\"></option></select><select ng-if=!scheme.multiple chosen no_results_text=\\\"\\'Результат не найден\\'\\\" placeholder-text-multiple=\\\"\\'Выберите один или несколько вариантов\\'\\\" placeholder-text-single=\\\"\\'Выберите один вариант\\'\\\" ng-options=\\\"b as b.title for b in list track by b.id\\\" ng-model=entityModel[fieldName]><option value=\\\"\\\"></option></select>\");\n$templateCache.put(\"app/directives/atomFieldPassword/atomFieldPassword.html\",\"<input autocomplete=off id=\\\"{{ itemName }}\\\" placeholder=\\\"\\\" type=password class=form-control ng-model=field>\");\n$templateCache.put(\"app/directives/atomFieldString/atomFieldString.html\",\"<input autocomplete=off id=\\\"{{ itemName }}\\\" placeholder=\\\"\\\" type=text class=form-control ng-model=field>\");\n$templateCache.put(\"app/directives/atomGlobalPopup/atomGlobalPopup.html\",\"<div class=modal-header><h3 class=modal-title>Внимание!</h3></div><div class=modal-body><p>{{ errorMessage }}</p></div><div class=modal-footer><button class=\\\"btn btn-primary\\\" type=button ng-click=closePopup()>Закрыть</button></div>\");\n$templateCache.put(\"app/directives/atomListField/atomListField.html\",\"{{ fieldLabel }}\");\n$templateCache.put(\"app/modules/demo/demo.html\",\"<div class=row><h1 class=demoTitle>DEMO</h1><p class=lead>Use this document as a way to quickly start any new project.<br>All you get is this text and a mostly barebones HTML document.</p><p class=lead localize>test</p></div>\");\n$templateCache.put(\"app/modules/errorPage/404.html\",\"<div class=page-err><div class=\\\"err-container text-center\\\"><div class=err><div class=err-inner><h1>404</h1><h2>Not Found</h2></div></div><div class=err-mss><p>{{$root.errorMessage}}</p></div><div class=err-body><a ui-sref=app class=\\\"btn btn-lg btn-primary\\\"><span class=space></span> Вернуться на главную</a></div></div><!--     <div class=\\\"footer text-center\\\">\\n            Copyright 2016 {{main.brand}} Admin\\n        </div> --></div>\");\n$templateCache.put(\"app/modules/errorPage/500.html\",\"<div class=page-err><div class=\\\"err-container text-center\\\"><div class=err><div class=err-inner><h1>500</h1><h2>Server Error</h2></div></div><div class=err-mss><p>{{$root.errorMessage}}</p></div><div class=err-body><a ui-sref=app class=\\\"btn btn-lg btn-primary\\\"><span class=space></span> Вернуться на главную</a></div></div><!--     <div class=\\\"footer text-center\\\">\\n            Copyright 2016 {{main.brand}} Admin\\n        </div> --></div>\");\n$templateCache.put(\"app/modules/page/page.html\",\"<div class=pageContent ng-bind-html=pageContent></div>\");\n$templateCache.put(\"app/modules/authorization/signin/authorization.html\",\"<div class=page-signin><div class=main-body><div class=container><div class=form-container><form class=form-horizontal ng-submit=makeLogin() autocomplete=off><fieldset><input style=display:none> <input type=password style=display:none><div class=form-group><div class=\\\"btn-icon-lined btn-icon-round btn-icon-sm btn-default-light\\\"><span class=\\\"glyphicon glyphicon-envelope\\\"></span></div><input type=email class=\\\"form-control input-lg input-round text-center\\\" placeholder=Email ng-model=user.email></div><div class=form-group><div class=\\\"btn-icon-lined btn-icon-round btn-icon-sm btn-default-light\\\"><span class=\\\"glyphicon glyphicon-lock\\\"></span></div><input type=password class=\\\"form-control input-lg input-round text-center\\\" placeholder=Пароль ng-model=user.password></div><div class=form-group><label class=\\\"ui-checkbox rememberMeLabel\\\"><input name=checkbox1 type=checkbox value=option2 ng-model=rememberMe> <span>Запомнить меня</span></label></div><div class=form-group><input type=submit class=\\\"btn btn-primary btn-lg btn-round btn-block text-center\\\" value=Войти></div></fieldset></form></div></div></div></div>\");\n$templateCache.put(\"app/modules/authorization/signup/registration.html\",\"<div class=page-signin><div class=main-body><div class=container><div class=form-container><form class=form-horizontal ng-submit=makeRegistration() autocomplete=off><fieldset><input style=display:none> <input type=password style=display:none><div class=form-group><div class=\\\"btn-icon-lined btn-icon-round btn-icon-sm btn-default-light\\\"><span class=\\\"glyphicon glyphicon-envelope\\\"></span></div><input type=email class=\\\"form-control input-lg input-round text-center\\\" placeholder=Email ng-model=user.email></div><div class=form-group><div class=\\\"btn-icon-lined btn-icon-round btn-icon-sm btn-default-light\\\"><span class=\\\"glyphicon glyphicon-lock\\\"></span></div><input type=password class=\\\"form-control input-lg input-round text-center\\\" placeholder=Пароль ng-model=user.password></div><div class=form-group><input type=submit class=\\\"btn btn-primary btn-lg btn-round btn-block text-center\\\" value=Зарегистироваться></div></fieldset></form></div></div></div></div>\");\n$templateCache.put(\"app/modules/demo/read/demoRead.html\",\"<h1>DEMO READ</h1><p class=lead translate>test</p>\");\n$templateCache.put(\"app/modules/log/create/LogCreate.html\",\"<form><input type=text style=\\\"position: absolute;left: -1000px\\\"> <input type=password style=\\\"position: absolute;left: -1000px\\\"><div class=form-group ng-repeat=\\\"(itemName, item) in scheme\\\"><label class=col-sm-2 for=\\\"{{ itemName }}\\\">{{ item.title }} <span class=require>*</span></label><div class=col-sm-10 ng-if=\\\"item.type === \\'string\\'\\\" atom-field-string field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'password\\'\\\" atom-field-password field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'boolean\\'\\\" atom-field-boolean field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'entity\\'\\\" atom-field-entity field=entity[itemName] field-name=itemName linked-entity=linkedEntities[item.entity.model] entity-model=entityModels scheme=item></div><div style=\\\"clear: both; margin-bottom: 10px\\\"></div></div></form><div style=\\\"clear: both\\\"></div><button type=button ng-click=save()>Save</button>\");\n$templateCache.put(\"app/modules/log/index/LogIndex.html\",\"<div class=\\\"panel panel-default\\\"><div class=panel-heading>{{ entityTitle }} <a ui-sref=app.log.create>Создать новый</a></div><table class=table><thead><tr><th ng-repeat=\\\"item in scheme\\\">{{ item.title }}</th><th>Действия</th></tr></thead><tbody><tr ng-repeat=\\\"entity in entities\\\"><td ng-repeat=\\\"(itemName, item) in scheme\\\" linked-entity=linkedEntities[itemName] atom-list-field scheme=item field-name=itemName field=entity[itemName]></td><td><a class=\\\"btn-icon btn-icon-min-sm btn-edit\\\" ui-sref=\\\"app.log.read({_id: entity._id.$id})\\\"><i class=\\\"glyphicon glyphicon-pencil ng-scope\\\"></i> </a><a class=\\\"btn-icon btn-icon-min-sm btn-remove\\\" ng-click=remove(entity._id.$id)><i class=\\\"glyphicon glyphicon-trash\\\"></i></a></td></tr></tbody></table></div>\");\n$templateCache.put(\"app/modules/log/read/LogRead.html\",\"<form><input type=text style=\\\"position: absolute;left: -1000px\\\"> <input type=password style=\\\"position: absolute;left: -1000px\\\"><div class=form-group ng-repeat=\\\"(itemName, item) in scheme\\\"><label class=col-sm-2 for=\\\"{{ itemName }}\\\">{{ item.title }} <span class=require>*</span></label><div class=col-sm-10 ng-if=\\\"item.type === \\'string\\'\\\" atom-field-string field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'password\\'\\\" atom-field-password field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'boolean\\'\\\" atom-field-boolean field=entity[itemName] field-name=itemName scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'entity\\'\\\" atom-field-entity field=entity[itemName] field-name=itemName linked-entity=linkedEntities[item.entity.model] entity-model=entityModels scheme=item></div><div class=col-sm-10 ng-if=\\\"item.type === \\'date\\' || item.type === \\'time\\' || item.type === \\'datetime\\'\\\" atom-field-datetime field=entity[itemName] field-name=itemName scheme=item></div><div style=\\\"clear: both; margin-bottom: 10px\\\"></div></div></form><div style=\\\"clear: both\\\"></div><button type=button ng-click=save()>Save</button>\");}]);"],"sourceRoot":"/source/"}